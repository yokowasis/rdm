var d=new Date,versionApp="?"+RDM_version,TimeZoneDiv=TzDifference-d.getTimezoneOffset(),RdmApp=angular.module("RdmApp",["ngCookies","ui.router","ui.bootstrap","oc.lazyLoad","ngSanitize","datatables","angularFileUpload","infinite-scroll","ADM-dateTimePicker","datatables.buttons"]);RdmApp.constant("ConstantAlias",{}),RdmApp.config(["$controllerProvider",function(a){}]),RdmApp.controller("HeaderController",["$scope",function(a){a.$on("$includeContentLoaded",(function(){}))}]),RdmApp.config(["$ocLazyLoadProvider",function(a){a.config({})}]),RdmApp.run(["$rootScope","$location","$state","$http","$window","$cookies",function(a,e,t,n,o,r){a.$state=t,a.userData=r.get("rdmData")||{},a.$on("$stateChangeStart",(function(){jQuery.blockUI({})})),a.$on("$viewContentLoaded",(function(){try{jQuery.unblockUI({})}catch(a){}})),a.$on("$stateChangeSuccess",(function(){jQuery.blockUI({}),setTimeout((function(){}),500);try{$scope.$apply()}catch(a){}})),t.defaultErrorHandler((function(a){window.myAppErrorLog.push(a)})),a.$on("$stateChangeError",(function(){jQuery.blockUI({}),Swal.fire({type:"error",title:"Error",showConfirmButton:!0,html:"Tidak dapat memuat halaman yang anda minta."})})),a.$on("$stateNotFound",(function(){jQuery.unblockUI({})})),a.$on("$locationChangeStart",(function(e,t,n){setTimeout((function(){$(".datepicker").hide()}),500);var o=r.get("rdmData")||"",i=r.get("_revision")||"";""==o?(console.log("Reload web"),window.location.reload()):(i!==RDM_version&&(clearCacheWB(),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Terdapat pembaharuan aplikasi, aplikasi akan dimuat ulang",timer:1500}).then((a=>{a.dismiss===Swal.DismissReason.timer&&(console.log("Reload web"),window.location.reload())}))),a.userData=JSON.parse(o),a.userData.nama=a.userData.nama.replace("+"," "))}))}]),RdmApp.controller("SidebarController",["$state","$scope",function(a,e){setTimeout((function(){handleSidebarMenuActiveLink("match",null,a)}),1e3),e.$on("$includeContentLoaded",(function(){Array.from(document.querySelectorAll(".c-sidebar")).forEach((function(a){Sidebar._sidebarInterface(a)}))}))}]),RdmApp.controller("rdmController",["$rootScope","$state","$scope","$cookies","ApiServer",function(a,e,t,n,o){a.base_url=base_url,a.logResize=function(){},a.arrPush=function(a){var e={};return angular.forEach(a,(function(a,t){e[t]=a})),e},a.cekLogin=function(){""==(n.get("rdmData")||"")&&(console.log("Reload web"),window.location.reload())},a.getToken=function(){return n.get("accessToken")||""},a.customepdf=function(a,e,t){a.content.splice(0,1);var n=new Date,o=n.getDate()+"-"+(n.getMonth()+1)+"-"+n.getFullYear();a.pageMargins=[20,60,20,40],a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14,a.header=function(){return{columns:[{alignment:"left",italics:!0,text:e,fontSize:14,margin:[10,0]},{alignment:"right",fontSize:14,text:t}],margin:20}},a.footer=function(a,e){return{columns:[{alignment:"left",text:["Created on: ",{text:o.toString()}]},{alignment:"right",text:["page ",{text:a.toString()}," of ",{text:e.toString()}]}],margin:20}};var r={hLineWidth:function(a){return.5},vLineWidth:function(a){return.5},hLineColor:function(a){return"#aaa"},vLineColor:function(a){return"#aaa"},paddingLeft:function(a){return 8},paddingRight:function(a){return 4}};return a.content[0].layout=r,a};var r=0,i=setInterval((function(){!function(){r>100?r>=107&&(clearInterval(i),$(".pre-loader").hide()):(a=r,document.getElementById("bar1").style.width=a+"%",document.getElementById("percent1").innerHTML=a+"%");var a;r++}()}),10)}]),RdmApp.controller("guruController",["$rootScope","$state","$scope","ApiServer","$location",function(a,e,t,n,o){a.dataTimeline=[],a.selectKelas="",a.posts=[],a.datasiswa=[],a.walas="",a.dataeksekutif={},a.dataextra=[],a.datakelas=[],a.profile={},a.aktif={},a.aktif.semester_id="",a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("guru/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),o.path("/dashboard"),setTimeout((function(){console.log("Reload web"),location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getprofile=function(){n.get("guru/profile",(function(e){a.profile=e.data}))},a.getprofile(),a.getdatakelas=function(){n.get("guru/getkelas",(function(n){a.datakelas=n.data,a.dataajar=n.kelas,a.walas=n.walas,a.datawalas=n.datawalas,a.extra=n.extra,a.dataextra=n.dataextra,a.p5ra=n.p5ra,console.log("KelasChange"),t.$broadcast("KelasChange",a.datakelas),t.$broadcast("KelasWalas",a.datawalas),setTimeout((function(){handleSidebarMenuActiveLink("match",null,e)}),1e3)}))},a.getdatakelas(),a.getsemester=function(){n.get("guru/datasemester",(function(e){a.datasemester=e.data}))},a.getsemester(),a.getreference=function(){n.get("guru/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference()}]),RdmApp.controller("proktor",["$rootScope","$state","$scope","ApiServer","FileUploader","$location",function(a,e,t,n,o,r){a.datasiswa={},a.tempdatasiswa={},a.dataguru={},a.dataeksekutif={},a.datakelas={},a.MapelInduk={},a.datarombel={},a.datasemester={},a.dataekstrakurikuler={},a.loaddatasiswa=!0,a.aktif={},a.aktif.semester_id="",a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.kurikulum={},a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("proktor/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),r.path("/dashboard"),setTimeout((function(){console.log("Reload web"),window.location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getdataguru=function(){n.get("proktor/guru/data",(function(e){a.dataguru=e.data}))},a.getdataadmin=function(){n.get("proktor/admin/data",(function(e){a.dataadminrdm=e.data}))},a.dataEmisSync=!1,a.emisLembagaid="",a.checkSyncEmis=function(){n.get("proktor/checkEmis",(function(e){a.dataEmisSync=e.data,a.emisLembagaid=e.lembagaid}))},a.checkSyncEmis(),a.getreference=function(){n.get("proktor/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference(),a.rendering=!1,a.chekupdate=function(){n.get("proktor/chekupdate",(function(e){0==e.success&&Swal.fire({title:"Update RDM",text:"Tersedia update aplikasi!",type:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ya, Update sekarang!"}).then((e=>{e.value&&a.doupdate("download")}))}))},a.updatedone=function(){$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang proses update!</h2>",baseZ:9999}),n.get("login/updatedone",(function(a){$.unblockUI({}),a.success?Swal.fire({type:"success",title:"Update Berhasil",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:"Aplikasi RDM sukses di update ke versi terbaru."}).then((a=>{a.value&&(console.log("Reload web"),window.location.reload())})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal menyimpan update RDM."})}))},a.doupdate=function(e){console.log("Update Confirm"+e),"download"==e?$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang mendownload Update!</h2>",baseZ:9999}):$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang proses update!</h2>",baseZ:9999}),n.get("updatenew.php?"+e,(function(t){$.unblockUI({}),console.log(t.success),t.success?"download"==e?a.doupdate("extract"):"extract"==e&&a.updatedone():void 0!==t.message?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}):"download"==e?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengunduh file update."}):"extract"==e&&Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengextract file update."})}))},a.chekupdate(),a.getdatasiswa=function(e){$.blockUI({}),n.post("proktor/siswa/data",e,(function(e){$.unblockUI({}),a.datasiswa=e.data}))},a.getajarmapel=function(e){$.blockUI({}),n.post("proktor/ajar/mapel",e,(function(e){$.unblockUI({}),a.mapelajar=e.mapel}))},a.getdataajar=function(e){$.blockUI({}),n.post("proktor/ajar/data",e,(function(e){$.unblockUI({}),a.dataajar=e.data,a.mapelajar=e.mapel}))},a.datasiswa={},a.pimpinan={},a.getprofile=function(){n.get("proktor/profile",(function(e){a.profile=e.data,a.pimpinan=e.pimpinan}))},a.getprofile(),a.aturcetak={},a.rechaptcha={},a.mobile={},a.getdataadmin(),a.getdataguru(),a.getpengaturan=function(){n.get("proktor/pengaturan/data",(function(e){a.tahunajaran=e.tahunajaran,a.datasemester=e.semester,a.aturcetak=e.aturcetak,a.penilaian.system=e.sistem_penilaian,a.mobile=e.mobile,a.rechaptcha=e.rechaptcha}))},a.penilaian={},a.getpengaturan(),a.getsemester=function(){n.get("proktor/semester/data",(function(e){a.datasemester=e.data,a.aturcetak=e.aturcetak}))},a.gettahunajaran=function(){n.get("proktor/tahunajaran/data",(function(e){a.tahunajaran=e.data}))},a.dataKelas=[],a.getdatakelas=function(){n.get("proktor/kelas/data",(function(e){a.dataKelas=e.data,a.getdatatingkat(),t.$broadcast("KelasChange",a.datakelas)}))},a.getdatakelas(),a.getdatatingkat=function(){n.get("proktor/kelas/datatingkat",(function(e){a.tingkat=e.tingkat,a.jurusan=e.jurusan,a.kelas=e.kelas,a.kurikulum=e.kurikulum}))},a.getdataekstra=function(){a.rendering=!1,n.get("proktor/ekstrakurikuler/data",(function(e){$.unblockUI({}),a.dataekstrakurikuler=e.data,setTimeout((function(){a.rendering=!0}))}))},a.reloaddataProktor=function(){a.getdataguru(),a.getprofile(),a.getsemester(),a.gettahunajaran(),a.getdataMapel(),a.getdatakelas()};var i=t.updater=new o({url:base_url+"proktor/updatemanual"});t.hapussemua=function(){i.clearQueue()},i.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),i.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|zip|".indexOf(t)}}),i.onErrorItem=function(a,e,t,n){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Koneksi ke server gagal."})},i.onSuccessItem=function(e,n,o,r){t.$apply(),n.success?(t.datarestore=n.data,$(".update-modal").modal("hide"),a.doupdate("extract")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message})},i.onCompleteAll=function(){t.hapussemua()},i.onBeforeUploadItem=function(a){a.url=base_url+"proktor/updatemanual"},i.onAfterAddingAll=function(a){i.uploadAll()}}]),RdmApp.controller("administrasi",["$rootScope","$state","$scope","ApiServer","$location",function(a,e,t,n,o){a.datasiswa={},a.tempdatasiswa={},a.dataguru={},a.dataeksekutif={},a.datakelas={},a.MapelInduk={},a.datarombel={},a.datasemester={},a.dataekstrakurikuler={},a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.loaddatasiswa=!0,a.aktif={},a.aktif.semester_id="",a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("administrasi/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),o.path("/dashboard"),setTimeout((function(){console.log("Reload web"),window.location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getdataguru=function(){n.get("proktor/guru/data",(function(e){a.dataguru=e.data}))},a.rendering=!1,a.chekupdate=function(){n.get("administrasi/chekupdate",(function(e){0==e.success&&Swal.fire({title:"Update RDM",text:"Tersedia update aplikasi!",type:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ya, Update sekarang!"}).then((e=>{e.value&&a.doupdate("download")}))}))},a.getdatasiswa=function(e){$.blockUI({}),n.post("proktor/siswa/data",e,(function(e){$.unblockUI({}),a.datasiswa=e.data}))},a.getajarmapel=function(e){$.blockUI({}),n.post("proktor/ajar/mapel",e,(function(e){$.unblockUI({}),a.mapelajar=e.mapel}))},a.getdataajar=function(e){$.blockUI({}),n.post("proktor/ajar/data",e,(function(e){$.unblockUI({}),a.dataajar=e.data,a.mapelajar=e.mapel}))},a.datasiswa={},a.pimpinan={},a.getreference=function(){n.get("proktor/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference(),a.dataEmisSync=!1,a.emisLembagaid="",a.checkSyncEmis=function(){n.get("administrasi/checkEmis",(function(e){a.dataEmisSync=e.data,a.emisLembagaid=e.lembagaid}))},a.checkSyncEmis(),a.getprofile=function(){n.get("administrasi/profile",(function(e){a.profile=e.data,a.dataprofile=e.profile}))},a.getprofile(),a.aturcetak={},a.getdataguru(),a.getpengaturan=function(){n.get("proktor/pengaturan/data",(function(e){a.tahunajaran=e.tahunajaran,a.datasemester=e.semester,a.aturcetak=e.aturcetak,a.penilaian.system=e.sistem_penilaian}))},a.penilaian={},a.getpengaturan(),a.getsemester=function(){n.get("proktor/semester/data",(function(e){a.datasemester=e.data,a.aturcetak=e.aturcetak}))},a.gettahunajaran=function(){n.get("proktor/tahunajaran/data",(function(e){a.tahunajaran=e.data}))},a.dataKelas={},a.getdatakelas=function(){n.get("proktor/kelas/data",(function(e){a.dataKelas=e.data,a.getdatatingkat(),t.$broadcast("KelasChange",a.datakelas)}))},a.getdatakelas(),a.getdataMapel=function(){n.get("proktor/mapel/data",(function(e){a.dataMapel=e.data,a.MapelInduk=e.induk}))},a.getdataMapel(),a.getdatatingkat=function(){n.get("proktor/kelas/datatingkat",(function(e){a.tingkat=e.tingkat,a.jurusan=e.jurusan,a.kelas=e.kelas,a.kurikulum=e.kurikulum}))},a.getdataekstra=function(){a.rendering=!1,n.get("administrasi/ekstrakurikuler/data",(function(e){$.unblockUI({}),a.dataekstrakurikuler=e.data,setTimeout((function(){a.rendering=!0}))}))},a.reloaddataProktor=function(){a.getdataguru(),a.getprofile(),a.getsemester(),a.gettahunajaran(),a.getdataMapel(),a.getdatakelas()}}]);
angular.module("RdmApp").directive("select2",["$timeout","$parse",function(e,n){return{restrict:"A",scope:{selectWidth:"@",ngModel:"=",ngDisabled:"="},link:function(e,n,t){e.selectWidth=e.selectWidth||"100%",n.select2({width:e.selectWidth,height:33,disabled:e.ngDisabled}),e.$watch("ngModel",(function(e,t){window.setTimeout((function(){n.select2("val",e)}))}))}}}]),RdmApp.directive("ngXlinkHref",(function(){return{priority:99,restrict:"A",link:function(e,n,t){t.$observe("ngXlinkHref",(function(e){e&&t.$set("xlink:href",e)}))}}})),RdmApp.directive("onSizeChanged",["$window",function(e){return{restrict:"A",scope:{onSizeChanged:"&"},link:function(n,t,i){var o=t[0];!function(e,n){e.cachedElementWidth=n.offsetWidth,e.cachedElementHeight=n.offsetHeight}(n,o),e.addEventListener("resize",(function(){if(n.cachedElementWidth!=o.offsetWidth||n.cachedElementHeight!=o.offsetHeight){n.onSizeChanged()()}}))}}}]),RdmApp.directive("ngBindHtmlUnsafe",[function(){return function(e,n,t){n.addClass("ng-binding").data("$binding",t.ngBindHtmlUnsafe),e.$watch(t.ngBindHtmlUnsafe,(function(e){"0"==e?n.html("0"):n.html(e||"")}))}}]),RdmApp.directive("bDatepicker",(function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",minDate:"=",maxDate:"="},link:function(e,n,t,i){var o={format:"yyyy-mm-dd",autoclose:!0,onSelect:function(n){!function(n){console.log(n),""!==n&&e.$apply((function(){i.$setViewValue(n)}))}(n),this.focus()},onClose:function(e){this.blur()}};e.$watch("maxDate",(function(e,t){$(n).datepicker("option","endDate",e)})),e.$watch("minDate",(function(e,t){$(n).datepicker("option","startDate",e),$(n).datepicker("option","defaultDate",e)})),e.$watch("ngModel",(function(e){n.datepicker("setDate",new Date(e))})),n.datepicker(o)}}})),RdmApp.directive("timeAgo",["timeAgo","nowTime",function(e,n){return{restrict:"EA",link:function(t,i,o){var r;o.$observe("fromTime",(function(n){r=e.parse(n)})),t.$watch((function(){return n()-r}),(function(n){$(i).text(e.inWords(n))}))}}}]),RdmApp.directive("whenScrolled",(function(){return{restrict:"A",link:function(e,n,t){raw=n[0],console.log(n),n.bind("scroll",(function(){console.log("scroll"),raw.scrollTop+raw.offsetHeight+5>=raw.scrollHeight&&(e.loading=!0,e.$apply(t.whenScrolled))}))}}})),RdmApp.factory("httpPostFactory",["$http",function(e){return function(n,t,i){e({url:n,method:"POST",data:t,headers:{"Content-Type":void 0}}).then((function(e){console.log(e),i(e.data)}))}}]),RdmApp.directive("bnLazySrc",["$window","$document",function(e,n){var t=function(){var t=[],i=null,o=$(e),r=n,c=r.height(),l=null,a=!1;function u(){if(!i){var e=r.height();e!==c&&(c=e,d())}}function f(){console.log("Checking for visible images...");for(var e=[],n=[],i=o.height(),r=o.scrollTop(),c=r+i,l=0;l<t.length;l++){var a=t[l];a.isVisible(r,c)?e.push(a):n.push(a)}for(l=0;l<e.length;l++)e[l].render();t=n,s(),t.length||h()}function s(){clearTimeout(i),i=null}function d(){i=setTimeout(f,100)}function h(){a=!1,o.off("resize.bnLazySrc"),o.off("scroll.bnLazySrc"),clearInterval(l)}function g(){i||d()}return{addImage:function(e){t.push(e),i||d(),a||(a=!0,o.on("resize.bnLazySrc",g),o.on("scroll.bnLazySrc",g),l=setInterval(u,2e3))},removeImage:function(e){for(var n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}t.length||(s(),h())}}}();function i(e){var n=null,t=!1,i=null;function o(){""!==n&&n!==base_url&&(e[0].src=n)}return{isVisible:function(n,t){if(!e.is(":visible"))return!1;null===i&&(i=e.height());var o=e.offset().top,r=o+i;return o<=t&&o>=n||r<=t&&r>=n||o<=n&&r>=t},render:function(){t=!0,o()},setSource:function(e){n=e,t&&o()}}}return{link:function(e,n,o){var r=new i(n);t.addImage(r),o.$observe("bnLazySrc",(function(e){r.setSource(e)})),e.$on("$destroy",(function(){t.removeImage(r)}))},restrict:"A"}}]);
RdmApp.factory("ApiServer",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).done((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,a){r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).done((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,r){a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("ApiPusat",["$http","$rootScope","$timeout",function(e,n,t){var r={};return r.post=function(e,r,a){n.cekLogin();var o=n.getToken();$.ajax({url:"https://rdm.hdmadrasah.id/api/"+e,method:"POST",dataType:"json",crossDomain:!0,contentType:"application/json; charset=utf-8",data:JSON.stringify(r),cache:!1,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+o)},success:function(e){t((function(){a(e)}),1e3)},error:function(e,n,t){a({success:!1,message:"Gagal menghubungi server."})}})},r}]),RdmApp.factory("common",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).success((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).success((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("nowTime",["$timeout",function(e){var n=Date.now()-6e4*TimeZoneDiv,t=function(){e((function(){n=Date.now()-6e4*TimeZoneDiv,t()}),1e4)};return t(),function(){return n}}]),RdmApp.factory("timeAgo",["$timeout",function(e){var n={settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"lalu",suffixFromNow:"dari sekarang",seconds:"baru saja",minute:"semenit",minutes:"%d menit",hour:"Sejam",hours:"%d jam",day:"sehari",days:"%d hari",month:"sebulan",months:"%d bulan",year:"setahun",years:"%d tahun",numbers:[]}},inWords:function(e){var t=n.settings.strings,r=t.prefixAgo,a=t.suffixAgo;n.settings.allowFuture&&e<0&&(r=t.prefixFromNow,a=t.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,u=i/24,c=u/365;function p(n,r){var a=$.isFunction(n)?n(r,e):n,o=t.numbers&&t.numbers[r]||r;return a.replace(/%d/i,o)}var m=o<45&&p(t.seconds,Math.round(o))||o<90&&p(t.minute,1)||s<45&&p(t.minutes,Math.round(s))||s<90&&p(t.hour,1)||i<24&&p(t.hours,Math.round(i))||i<42&&p(t.day,1)||u<30&&p(t.days,Math.round(u))||u<45&&p(t.month,1)||u<365&&p(t.months,Math.round(u/30))||c<1.5&&p(t.year,1)||p(t.years,Math.round(c)),f=void 0===t.wordSeparator?" ":t.wordSeparator;return o<45?$.trim([r,m,""].join(f)):$.trim([r,m,a].join(f))},parse:function(e){if(angular.isNumber(e))return parseInt(e,10);var n=$.trim(e);return n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)}};return n}]);
angular.module("RdmApp").filter("html",["$sce",function(t){return t.trustAsHtml}]);
angular.module("RdmApp").config(["$stateProvider","$urlRouterProvider",function(a,e){e.otherwise("/dashboard"),a.state("dashboard",{url:"/dashboard",templateUrl:"default.html",data:{pageTitle:"Beranda RDM",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"DashboardCtrl"}).state("pengaturan",{url:"/pengaturan",templateUrl:"pengaturan.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pengaturanCtrl"}).state("profile",{url:"/profile",templateUrl:"profile.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"profileCtrl"}).state("semester",{url:"/semester",templateUrl:"semester.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"semesterCtrl"}).state("aturcetak",{url:"/aturcetak",templateUrl:"aturcetak.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"aturcetakCtrl"}).state("mapel",{url:"/mapel",templateUrl:"mapel.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"mapelCtrl"}).state("indikator",{url:"/indikator",templateUrl:"indikator.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"indikatorCtrl"}).state("kelas",{url:"/kelas",templateUrl:"kelas.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kelasCtrl"}).state("dataguru",{url:"/dataguru",templateUrl:"guru.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"guruCtrl"}).state("datasiswa",{url:"/datasiswa",templateUrl:"siswa.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"siswaCtrl"}).state("riwayatsiswa",{url:"/riwayatsiswa",templateUrl:"riwayatsiswa.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"riwayatsiswaCtrl"}).state("dataajar",{url:"/dataajar",templateUrl:"ajar.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"ajarCtrl"}).state("naikkelas",{url:"/naikkelas",templateUrl:"naikkelas.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"naikkelasCtrl"}).state("pindahkelas",{url:"/pindahkelas",templateUrl:"pindahkelas.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pindahkelasCtrl"}).state("pindahsemester",{url:"/pindahsemester",templateUrl:"pindahsemester.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pindahsemesterCtrl"}).state("ekstrakurikuler",{url:"/ekstrakurikuler",templateUrl:"ekstrakurikuler.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"ekstraCtrl"}).state("kkmtingkat",{url:"/kkmtingkat",templateUrl:"kkmtingkat.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kkmtingkatCtrl"}).state("backuprestore",{url:"/backuprestore",templateUrl:"backuprestore.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"backuprestoreCtrl"}).state("statusnilai",{url:"/statusnilai",templateUrl:"statusnilai.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"statusnilaiCtrl"}).state("cetakrapor",{url:"/cetakrapor",templateUrl:"cetakrapor.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"cetakraporCtrl"}).state("kirimnilai",{url:"/kirimnilai",templateUrl:"kirimnilai.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kirimnilaiCtrl"}).state("adminrdm",{url:"/adminrdm",templateUrl:"adminrdm.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"adminrdmCtrl"}).state("alumni",{url:"/alumni",templateUrl:"alumni.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"alumniCtrl"}).state("koordinator",{url:"/koordinator",templateUrl:"pembina.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"pembinaCtrl"}).state("targetp5",{url:"/targetp5",templateUrl:"targetp5.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"targetp5Ctrl"}).state("raporp5",{url:"/raporp5",templateUrl:"raporp5.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"raporp5Ctrl"})}]);
angular.module("RdmApp").controller("DashboardCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(o,d,r,a,t,n,e,l){d.dashboard=[],o.getdashboard=function(){l.get("proktor/dashboard",(function(o){d.dashboard=o.data,d.logAdmin=o.log}))},o.getdashboard()}]);

angular.module("RdmApp").controller("adminrdmCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,o,i,n,l,d,r){a.dtInstance={},a.datakelasedit={},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("proktor/admin/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getdataadmin(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{e.value&&($.blockUI({}),d.post("proktor/admin/delete",{guru_id:a},(function(a){$.unblockUI({}),a.success?(t.getdataadmin(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.dodataUpload=function(){$(".upload-modal").modal("show")},a.dodataTambah=function(){a.dataEdit={},a.dataEdit.edit=!1},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=o.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5,7,8,9]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Data Guru","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5,7,8,9]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var s=a.uploader=new r({url:base_url+"proktor/guru/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){s.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},s.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),s.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),s.onSuccessItem=function(t,e,o,i){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,o,i,a.gandaaa)},s.onCompleteAll=function(){t.getdataadmin()},s.onBeforeUploadItem=function(a){a.url=base_url+"proktor/guru/import"},s.onAfterAddingAll=function(a){s.uploadAll()}}]);
angular.module("RdmApp").controller("ajarCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,l,o,n,r,s){a.dtInstance={},a.dataEdit={},a.setmengjar=function(e,i){$.blockUI({}),r.post("proktor/ajar/save",e,(function(e){$.unblockUI({}),t.getdataguru(),e.success?(i.dataEdit.delete=e.data,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):(a.reloadTable(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}))}))},a.dodataDelete=function(e,i){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((l=>{console.log(l),l.value&&($.blockUI({}),r.post("proktor/ajar/delete",{ajar_id:e.delete},(function(l){$.unblockUI({}),t.getdataguru(),l.success?(i.select={},i.select.guru_id="",e.delete="",e.edit="",Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):(a.reloadTable(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:l.message}))})))}))},a.dodeleteData=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((i=>{console.log(i),i.value&&($.blockUI({}),r.post("proktor/ajar/delete",{ajar_id:e},(function(e){$.unblockUI({}),t.getdataguru(),e.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:2e3}),a.reloadData()):(a.reloadTable(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}))})))}))},a.docopyAjar=function(){$(".copy-modal").modal("hide"),Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Salin!",showCancelButton:!0,html:"Apakah Anda yakin akan menyalin data mengajar dari semester ini?"}).then((e=>{console.log(e),e.value&&($.blockUI({}),r.post("proktor/ajar/salin",a.selectData,(function(e){$.unblockUI({}),t.getdataguru(),a.reloadTable(),e.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disalin",timer:2e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})))}))},t.dataajar={},a.tambahData={},a.tambahData.mapel_id="",a.tambahData.guru_id="",void 0!==t.profile?a.tambahData.semester_id=t.profile.semester_id:a.tambahData.semester_id="",a.loading=!1,a.reloadTable=function(){a.loading=!0,t.dataajar={},""!==a.selectData.kelas_id&&(t.getdataajar(a.selectData),setTimeout((function(){a.loading=!1}),1e3))},t.dataData={},a.reloadData=function(){t.dataData={},""!==a.tambahData.mapel_id&&""!==a.tambahData.guru_id&&($.blockUI({}),r.post("proktor/ajar/ajarkelas",a.tambahData,(function(a){$.unblockUI({}),t.dataData=a.data})))},t.knilai={},a.savedatapilihan=function(){$(".tambah-modal").modal("hide"),t.knilai.kirimajar=[],$i=0,t.knilai.mapel_id=a.tambahData.mapel_id,t.knilai.guru_id=a.tambahData.guru_id,angular.forEach(t.dataData,(function(a){if(1==a.select){var e={};e.kelas_id=a.kelas_id,e.tingkat_id=a.tingkat_id,t.knilai.kirimajar[$i]=e,$i++}})),t.knilai.kirimajar.length>0?($.blockUI({}),r.post("proktor/ajar/savepilihan",t.knilai,(function(t){$.unblockUI({}),null!==t&&t.success?(a.reloadTable(),a.reloadData(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3}).then((a=>{$(".tambah-modal").modal("show")}))):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Belum ada kelas dipilih"}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))},a.getmapel=function(){t.getajarmapel(a.tambahData)},a.tambahAjarguru=function(){$(".tambah-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.changeTingkat=function(){t.dataajar={},a.selectData.kelas_id=""},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.selectData.semester_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen ajar","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withOption("responsive",!0).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:-2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:2}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("ordering",!1).withOption("processing",!1);var d=a.uploader=new s({url:base_url+"proktor/ajar/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),d.onSuccessItem=function(t,e,i,l){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,l,a.gandaaa)},d.onCompleteAll=function(){a.reloadTable()},d.onBeforeUploadItem=function(t){t.url=base_url+"proktor/ajar/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("alumniCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,i,e,n,l,o,s,u){t.dtInstance={},t.dataEdit={},t.dobatalMutasi=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, batalkan!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan mutasi siswa ini?"}).then((i=>{i.value&&($.blockUI({}),s.post("proktor/siswa/batalmutasi",{siswa_id:a},(function(a){$.unblockUI({}),a.success?(t.getdataalumni(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Siswa Berhasil Dimutasi",timer:1e3})):(t.getdataalumni(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}))})))}))},t.reloadTable=function(){a.alumnidata={},""!==t.selectData.kelas_id?t.alumnidata=a.dataalumni.filter((function(a){return a.kelas_id==t.selectData.kelas_id})):t.alumnidata=t.dataalumni},t.dataalumni={},t.alumnidata={},t.getdataalumni=function(){$.blockUI({}),s.get("proktor/siswa/alumni",(function(a){$.unblockUI({}),t.dataalumni=a.data,t.reloadTable()}))},t.getdataalumni(),t.clearKelas=function(i){t.selectData.kelas_id="",a.datasiswa={}},t.selectData={},t.selectData.kelas_id="",t.selectData.tingkat_id="",t.dtOptions=e.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5,6]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Siswa","RDM")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5,6]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("aturcetakCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,r,l,o,c,n){t.saveTempatCetak=function(){$.blockUI({}),n.post("proktor/semester/cetaksave",{cetak_tanggal:e.aturcetak.cetak_tanggal,cetak_tempat:e.aturcetak.cetak_tempat,cetak_watermark:e.aturcetak.cetak_watermark},(function(t){$.unblockUI({}),null!==t&&t.success?(e.getsemester(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))}}]);
angular.module("RdmApp").controller("backuprestoreCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(e,t,a,r,o,n,s,i,l){e.dtInstance={},e.newextra={},e.newextra.ekstrakurikuler_nama="",e.newextra.guru_id="",t.getdatabck=function(){$.blockUI({}),i.get("proktor/backuprestore/data",(function(e){$.unblockUI({}),t.databackup=e.data}))},t.doBackupData=function(e){$.blockUI({}),$.post("proktor/backuprestore/backup/"+e).done((function(e,a,r){$.unblockUI({}),t.getdatabck(),"application/json"==(r.getResponseHeader("content-type")||"")?e.success?Swal.fire({type:"success",title:"Berhasil",text:"Backup File Berhasil Dibuat",showConfirmButton:!1,timer:1500}):Swal.fire({type:"error",title:"Gagal Membuat Backup",text:e.message,showConfirmButton:!0}):Swal.fire({type:"success",title:"Berhasil",text:"Backup File Berhasil Dibuat",showConfirmButton:!1,timer:1500})})).fail((function(e,a,r,o){$.unblockUI({}),t.getdatabck(),Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!0}),callback({success:!1,message:"Gagal menghubungi server."})}))},t.getdatabck(),e.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus backup ini?"}).then((a=>{a.value&&($.blockUI({}),i.post("proktor/backuprestore/delete",{filename:e},(function(e){$.unblockUI({}),e.success?(t.getdatabck(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})))}))},e.dodataEdit=function(t){e.editekstra(t.ekstrakurikuler_id,t.ekstrakurikuler_nama,t.guru_id,!0)},e.restore=function(){$(".upload-modal").modal("show")},e.currPg=0,e.dtOptions=r.newOptions().withOption("searching",!0).withOption("drawCallback",(function(t){if(t.aoData.length>0){var a=this.api().page.info();e.currPg=a.start}})).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers");var u=e.uploader=new l({url:base_url+"proktor/siswa/import"});e.errorCount=0,e.processRestore=function(a,r){var o=Math.round(a/e.datarestore.length*100);$.blockUI({message:"<h2>Harap bersabar!!</h2><h4>"+o+"% data sudah direstore!</h4>",baseZ:9999}),a<e.datarestore.length?(e.restoredata={},e.restoredata=e.datarestore[a],e.restoredata.start=r,i.post("proktor/backuprestore/prosesfile",e.datarestore[a],(function(o){o.success?(e.errorCount=0,0==o.pending?e.processRestore(a+1,0):e.processRestore(a,o.pending)):(e.errorCount++,e.errorCount>3?(t.getdatabck(),$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Direstore"})):e.processRestore(a,r))}))):(t.getdatabck(),$.unblockUI({}),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!0,html:"Data Berhasil Direstore"}).then((e=>{e.value&&t.reloaddataProktor()})))},e.berhasilaa=0,e.gandaaa=0,e.gagalaa=0,e.hapussemua=function(){u.clearQueue(),e.berhasilaa=0,e.gandaaa=0,e.gagalaa=0},u.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(e,t){var a="|"+e.name.substr(e.name.lastIndexOf(".")+1)+"|";if(console.info("type",a),-1!=="|rdm|".indexOf(a))return!0;$(".upload-modal").modal("hide"),Swal.fire({type:"error",title:"File backup",showConfirmButton:!0,html:"File yang anda upload bukan file Backup RDM, pastikan file backup memiliki extensi .rdm"}).then((e=>{e.value&&(u.clearQueue(),$(".upload-modal").modal("show"))}))}}),u.onSuccessItem=function(t,a,r,o){e.$apply(),a.success?(e.datarestore=a.data,$(".upload-modal").modal("hide"),null!==e.datarestore&&e.datarestore.length>0?e.processRestore(0,0):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}),console.info("onSuccessItem",t,a,r,o,e.gandaaa)},u.onCompleteAll=function(){u.clearQueue()},u.onBeforeUploadItem=function(e){e.url=base_url+"proktor/backuprestore/restore"},u.onAfterAddingAll=function(e){u.uploadAll()}}]);
angular.module("RdmApp").filter("filterSiswa",(function(){return function(a,e){var t=[];return void 0===e||""===e||angular.forEach(a,(function(a){a.rombel===e&&t.push(a)})),t}})),angular.module("RdmApp").controller("cetakraporCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,t,s,l,i,o,n,r){a.dtInstance={},a.dataEdit={},e.walassiswa={},a.reloadTable=function(){e.walassiswa={},""!==a.selectData.kelas_id&&($.blockUI({}),n.post("proktor/siswa/datasiswa",a.selectData,(function(a){$.unblockUI({}),e.walassiswa=a.data})))},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=s.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5,6]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Siswa","RDM")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5,6]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:4},{responsivePriority:3,targets:2},{responsivePriority:4,targets:3}]).withOption("responsive",!0).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers"),a.cetakAllNilai=function(t,s){console.log(t),console.log(e.walassiswa.length),t<e.walassiswa.length?($.blockUI({message:"Proses generate nilai "+e.walassiswa[t].siswa_nama+", <br> Proses data "+Math.round(100*(t+1)/e.walassiswa.length)+"% ("+(t+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/rapor/gennilaipdf/"+a.selectData.kelas_id+"/"+e.walassiswa[t].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllNilai(t+1,0):s>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate nilai",timer:2e3}):a.cetakAllNilai(t,s+1)}))):a.openNewAjaxTab("cetak/rapor/downnilaipdf/"+a.selectData.kelas_id)},a.cetakAllRapor=function(t,s){console.log(t),console.log(e.walassiswa.length),0==e.walassiswa.length||(t<e.walassiswa.length?($.blockUI({message:"Proses generate rapor "+e.walassiswa[t].siswa_nama+", <br> Proses data "+Math.round(100*(t+1)/e.walassiswa.length)+"% ("+(t+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/rapor/genraporpdf/"+a.selectData.kelas_id+"/"+e.walassiswa[t].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllRapor(t+1,0):s>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate rapor",timer:2e3}):a.cetakAllRapor(t,s+1)}))):a.openNewAjaxTab("cetak/rapor/downraporpdf/"+a.selectData.kelas_id))},a.cetakAllSampul=function(t,s){console.log(t),console.log(e.walassiswa.length),0==e.walassiswa.length||(t<e.walassiswa.length?($.blockUI({message:"Proses generate sampul "+e.walassiswa[t].siswa_nama+", <br> Proses data "+Math.round(100*(t+1)/e.walassiswa.length)+"% ("+(t+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/rapor/gensampulsiswapdf/"+a.selectData.kelas_id+"/"+e.walassiswa[t].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllSampul(t+1,0):s>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate sampul",timer:2e3}):a.cetakAllSampul(t,s+1)}))):a.openNewAjaxTab("cetak/rapor/downsampulpdf/"+a.selectData.kelas_id))},a.cetakAllIdentitas=function(t,s){console.log(t),console.log(e.walassiswa.length),0==e.walassiswa.length||(t<e.walassiswa.length?($.blockUI({message:"Proses generate identitas "+e.walassiswa[t].siswa_nama+", <br> Proses data "+Math.round(100*(t+1)/e.walassiswa.length)+"% ("+(t+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/rapor/genidentitassiswapdf/"+a.selectData.kelas_id+"/"+e.walassiswa[t].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllIdentitas(t+1,0):s>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate identitas",timer:2e3}):a.cetakAllIdentitas(t,s+1)}))):a.openNewAjaxTab("cetak/rapor/downidentitaspdf/"+a.selectData.kelas_id))},a.openNewAjaxTab=function(a){$.ajax({url:base_url+"cetak/rapor/validasi",method:"GET",headers:{"Content-type":"application/json"},responseType:"arraybuffer",success:function(e){var t,s=new XMLHttpRequest;s.open("GET",a,!0),s.responseType="arraybuffer",s.onload=function(a){t=new Blob([this.response])},s.onprogress=function(a){},s.onloadend=function(e){var s=document.createElement("a");document.body.appendChild(s),s.style="display: none",a=window.URL.createObjectURL(t),s.href=a,s.download="Download.pdf",s.click(),window.URL.revokeObjectURL(a)},s.send()},error:function(a){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal download",timer:2e3})}})}}]);
angular.module("RdmApp").controller("ekstraCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,r,i,n,o,s){t.dtInstance={},t.newextra={},t.newextra.ekstrakurikuler_nama="",t.newextra.guru_id="",t.setpembina=function(e){t.newextra=e,t.saveeditekstra1()},t.saveeditekstra1=function(){$.blockUI({}),s.post("proktor/ekstrakurikuler/save",t.newextra,(function(a){$.unblockUI({}),a.success?(t.newextra={},t.newextra.ekstrakurikuler_nama="",t.newextra.guru_id="",e.getdataekstra(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):(e.getdataekstra(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}))}))},t.saveeditekstra=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("proktor/ekstrakurikuler/save",t.newextra,(function(a){$.unblockUI({}),a.success?(t.newextra={},t.newextra.ekstrakurikuler_nama="",t.newextra.guru_id="",e.getdataekstra(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((t=>{t.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},t.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((a=>{a.value&&($.blockUI({}),s.post("proktor/ekstrakurikuler/delete",{ekstrakurikuler_id:t},(function(t){$.unblockUI({}),t.success?(e.getdataekstra(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.dodataEdit=function(e){t.editekstra(e.ekstrakurikuler_id,e.ekstrakurikuler_nama,e.guru_id,!0,e.extrakurikuler_wajib)},t.editekstra=function(e,a,r,i,n){t.newextra.ekstrakurikuler_id=e,t.newextra.ekstrakurikuler_nama=a,t.newextra.extrakurikuler_wajib=n,t.newextra.guru_id=r,t.newextra.edit=i,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.currPg=0,e.getdataekstra=function(){s.get("proktor/ekstrakurikuler/data",(function(t){$.unblockUI({}),e.dataekstrakurikuler1=t.data,e.datapembina1=t.guru}))},e.getdataekstra(),t.dtOptions=r.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("drawCallback",(function(e){if(e.aoData.length>0){var a=this.api().page.info();t.currPg=a.start}})).withOption("paging",!0).withOption("processing",!1).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("guruCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,e,i,o,n,r,l,s){t.dtInstance={},t.datakelasedit={},t.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("proktor/guru/save",t.dataEdit,(function(t){$.unblockUI({}),t.success?(a.getdataguru(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},t.dononaktif=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, proses!",showCancelButton:!0,html:"Apakah Anda yakin akan menonaktifkan guru ini?"}).then((e=>{e.value&&($.blockUI({}),l.post("proktor/guru/ubahstatus",{guru_id:t},(function(t){$.unblockUI({}),t.success?(a.getdataguru(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Non Aktifkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.doaktif=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, proses!",showCancelButton:!0,html:"Apakah Anda yakin akan mengaktifkan kembali guru ini?"}).then((e=>{e.value&&($.blockUI({}),l.post("proktor/guru/ubahstatus",{guru_id:t},(function(t){$.unblockUI({}),t.success?(a.getdataguru(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil diaktifkan kembali",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.dodataUpload=function(){$(".upload-modal").modal("show")},t.dodataTambah=function(){t.dataEdit={},t.dataEdit.edit=!1},t.dodataEdit=function(a){t.dataEdit=a,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5,7,8,9]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Data Guru","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5,7,8,9]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:3}]).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers");var u=t.uploader=new s({url:base_url+"proktor/guru/import"});t.berhasilaa=0,t.gandaaa=0,t.gagalaa=0,t.hapussemua=function(){u.clearQueue(),t.berhasilaa=0,t.gandaaa=0,t.gagalaa=0},u.filters.push({name:"customFilter",fn:function(t,a){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(t,a){var e="|"+t.name.substr(t.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),u.onSuccessItem=function(a,e,i,o){t.berhasilka=t.berhasilka+e.sukses,t.gandaaa=t.gandaaa+e.double1,t.gagalaa=t.gagalaa+e.gagal,t.$apply(),console.info("onSuccessItem",a,e,i,o,t.gandaaa)},u.onCompleteAll=function(){a.getdataguru()},u.onBeforeUploadItem=function(t){t.url=base_url+"proktor/guru/import"},u.onAfterAddingAll=function(t){u.uploadAll()}}]);
angular.module("RdmApp").controller("kelasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,i,l,s,o,n){a.dtInstance={},a.datakelasedit={},a.selectData={},a.selectData.tingkat_id="",a.datakelasfill={},a.filterupdate=function(){""!==a.selectData.tingkat_id?a.datakelasfill=t.dataKelas.filter((function(t){return t.tingkat_id==a.selectData.tingkat_id})):a.datakelasfill=t.dataKelas,console.log(a.datakelasfill)},a.filterupdate(),a.$on("KelasChange",(function(t,e){console.log("kelas change"),a.filterupdate()})),a.deletekelas=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus kelas ini?"}).then((e=>{e.value&&($.blockUI({}),n.post("proktor/kelas/delkelas",a,(function(a){$.unblockUI({}),a.success?(t.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.domigrasikelas=function(){$(".migrasi-modal").modal("hide"),Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Migrasi!",showCancelButton:!0,html:"Apakah Anda yakin akan mengubah sistem penilaian kelas ini?"}).then((e=>{e.value&&($.blockUI({}),n.post("proktor/kelas/migrasikelas",a.datakelasedit,(function(a){$.unblockUI({}),a.success?(t.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dimigrasi",timer:1e3})):($(".migrasi-modal").modal("show"),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}))})))}))},a.saveeditkelas=function(){$(".edit-modal").modal("hide"),$.blockUI({}),n.post("proktor/kelas/save",a.datakelasedit,(function(a){$.unblockUI({}),a.success?(t.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.savebatchkelas=function(){$(".batch-modal").modal("hide"),$.blockUI({}),n.post("proktor/kelas/savebatch",a.datakelasedit,(function(a){$.unblockUI({}),a.success?(t.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".batch-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.tambahKelas=function(t){a.datakelasedit={},a.datakelasedit.jumlah=2,a.datakelasedit.edit=!1},a.migrasikelas=function(e){a.datakelasedit=t.arrPush(e),a.datakelasedit.semester_id="",$(".migrasi-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.editkelas=function(e){a.datakelasedit=t.arrPush(e),a.datakelasedit.edit=!0,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:0},{responsivePriority:3,targets:-2},{responsivePriority:4,targets:-3}]).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("kirimnilaiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","ApiPusat","FileUploader","$compile",function(a,t,e,i,n,l,o,s,r,m,u){a.dtInstance={},a.tabelData={},a.dtColumns=[n.newColumn("no").withTitle("#").notSortable(),n.newColumn("nama_kelas").withTitle("Kelas"),n.newColumn("walikelas").withTitle("Wali Kelas").notSortable(),n.newColumn("jurusan_nama").withTitle("Jurusan").notSortable(),n.newColumn("semester_nama").withTitle("Semester").notSortable(),n.newColumn("persenkirim").withTitle("Persentase Nilai").notSortable(),n.newColumn("siswajml").withTitle("Jumlah Siswa").notSortable(),n.newColumn(null).withTitle("Aksi").notSortable().renderWith((function(t,e,i,n){var l="";3==a.tabelData[n.row].nilailock?l='<div class="btn-group m-1" role="group" aria-label="Basic example"><button class="btn btn-sm btn-danger" type="button" ng-click="dobatalKirim('+n.row+')"> <i class="c-icon fa fa-ban"></i> <span class="d-md-down-none">Batal Kirim</span> </button>':100!=a.tabelData[n.row].persenkirim&&2!=a.tabelData[n.row].nilailock||(l='<div class="btn-group m-1" role="group" aria-label="Basic example"><button class="btn btn-sm btn-success" type="button" ng-click="dodataKirim('+n.row+')"> <i class="c-icon fa fa-send"></i> <span class="d-md-down-none">Kirim</span> </button>');return l}))],a.dtOptions=i.newOptions().withOption("ajax",(function(t,e,i){console.log(t),$(".table-responsive").block({message:'<i class="fa fa-spinner fa-spin"></i>'}),s.post("proktor/kirimnilai/data",t,(function(t){$(".table-responsive").unblock({}),console.log(t),a.tabelData=t.results.data,e({recordsTotal:t.results.recordsTotal,recordsFiltered:t.results.recordsFiltered,data:t.results.data})}))})).withOption("language",{paginate:{first:"<i class='fa fa-fast-backward'></i>",previous:"<i class='fa fa-step-backward'></i>",next:"<i class='fa fa-step-forward'></i>",last:"<i class='fa fa-fast-forward'></i>|"}}).withDataProp("data").withDOM("lBfrtip").withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> PDF',download:"open",exportOptions:{columns:[0,1,2,3,4,5,6]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Data Lembaga","Pangkalan Data AKMI")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5,6]},titleAttr:"Excel"}]).withOption("drawCallback",(function(t){if(a.currPg=0,t.aoData.length>0){var e=this.api().page.info();console.log(e),a.currPg=e}})).withOption("columnDefs",[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1},{responsivePriority:3,targets:-2},{responsivePriority:4,targets:-3}]).withOption("responsive",!0).withDisplayLength(10).withOption("lengthMenu",[[10,25,50,100,-1],[10,25,50,100,"All"]]).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withOption("serverSide",!0).withOption("aaSorting",[0,"asc"]).withOption("createdRow",(function(t){u(angular.element(t).contents())(a)})).withPaginationType("full_numbers"),a.reloadTable=function(){$("#aktifTable").DataTable().ajax.reload(null,!1)},a.kirimsemuanilai=function(){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, kirim!",showCancelButton:!0,html:"Apakah Anda yakin akan mengirim semua nilai kelas yang belum terkirim?"}).then((t=>{t.value&&($.blockUI({message:"Mengechek data nilai kelas yang belum terkirim"}),s.get("proktor/kirimnilai/getkirimkelas",(function(t){t.success?(a.dataKirimKelas=t.data,console.log(a.dataKirimKelas),a.doKirimKelas(0)):(a.reloadTable(),$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}))})))}))},a.doKirimKelas=function(t){t<a.dataKirimKelas.length?(a.datakirim=a.dataKirimKelas[t],$.blockUI({message:"Menyiapkan data nilai kelas "+a.dataKirimKelas[t].nama_kelas}),s.post("proktor/kirimnilai/prepare",a.dataKirimKelas[t],(function(e){e.success?(a.dataPusat=e.data,a.doKirimPusat1(t,0,0)):(a.reloadTable(),$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}))}))):($.unblockUI({}),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Nilai kelas berhasil dikirim",timer:2e3}))},a.doKirimPusat1=function(t,e,i){e<a.dataPusat.length?(a.persen=Math.round(100*(e+1)/a.dataPusat.length),$.blockUI({message:"Mengirim data rapor "+a.dataPusat[e].siswa.siswa_nama+" ke pusat"}),r.post("kirimnilai",a.dataPusat[e],(function(n){n.success?a.doKirimPusat1(t,e+1,0):n.success?i<3?a.doKirimPusat1(t,e,i+1):(a.persen="",$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal Mengirim Nilai"})):(a.persen="",$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message}))}))):(a.persen="",$.unblockUI({}),a.dodataDone1(t))},a.dodataDone1=function(t){$.blockUI({message:"Update data nilai kelas "+a.datakirim.nama_kelas}),s.post("proktor/kirimnilai/done",a.datakirim,(function(e){e.success?($.unblockUI({}),a.reloadTable(),a.doKirimKelas(t+1)):($.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}))}))},a.dataKirimKelas=[],a.dodataKirim=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, kirim!",showCancelButton:!0,html:"Apakah Anda yakin akan mengirim data kelas "+a.tabelData[t].nama_kelas+"?"}).then((e=>{e.value&&(a.datakirim=a.tabelData[t],$.blockUI({message:"Menyiapkan data nilai kelas "+a.tabelData[t].nama_kelas}),s.post("proktor/kirimnilai/prepare",a.tabelData[t],(function(t){t.success?(a.dataPusat=t.data,a.doKirimPusat(0,0)):(a.reloadTable(),$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}))})))}))},a.dobatalKirim=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Batalkan!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan pengiriman data kelas "+a.tabelData[t].nama_kelas+"?"}).then((e=>{e.value&&(a.datakirim=a.tabelData[t],$.blockUI({message:"Mengecek status pengiriman kelas "+a.tabelData[t].nama_kelas}),s.post("proktor/kirimnilai/batalkirim",a.tabelData[t],(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Pengiriman nilai berhasil dibatalkan",timer:2e3})):(a.reloadTable(),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}))})))}))},a.datakirim={},a.persen="",a.doKirimPusat=function(t,e){t<a.dataPusat.length?(a.persen=Math.round(100*(t+1)/a.dataPusat.length),$.blockUI({message:"Mengirim data rapor "+a.dataPusat[t].siswa.siswa_nama+" ke pusat"}),r.post("kirimnilai",a.dataPusat[t],(function(i){i.success?a.doKirimPusat(t+1,0):i.success?e<3?a.doKirimPusat(t,e+1):(a.persen="",$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal Mengirim Nilai"})):(a.persen="",$.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}))}))):(a.persen="",$.unblockUI({}),a.dodataDone())},a.dodataDone=function(){$.blockUI({message:"Update data nilai kelas "+a.datakirim.nama_kelas}),s.post("proktor/kirimnilai/done",a.datakirim,(function(t){t.success?($.unblockUI({}),a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Nilai kelas "+a.datakirim.nama_kelas+" berhasil dikirim",timer:2e3})):($.unblockUI({}),Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}))}))},a.dataPusat=[]}]);
angular.module("RdmApp").controller("kkmtingkatCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,i,n,r,k,o){a.dtInstance={},a.kkmChange=function(a,t){var e=Math.round((100-parseInt(t))/3),i=Math.ceil((100-parseInt(t))/3),n=parseInt(t)+e,r=parseInt(n)+1*i;parseInt(t)<98?angular.forEach(a,(function(a,e){"A"==a.kkmgrade_kode?(a.kkmgrade_max=100,a.kkmgrade_min=r):"B"==a.kkmgrade_kode?(a.kkmgrade_max=parseInt(r)-1,a.kkmgrade_min=n):"C"==a.kkmgrade_kode?(a.kkmgrade_max=parseInt(n)-1,a.kkmgrade_min=t):(a.kkmgrade_max=parseInt(t)-1,a.kkmgrade_min=0)})):Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!0,html:"Nilai KKM tidak boleh melebihi angka 97"})},a.saveKkmTingkat=function(a){$(".edit-modal").modal("hide"),$.blockUI({}),o.post("proktor/kkmtingkat/save",a,(function(a){$.unblockUI({}),a.success?(t.getdatakkm(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.editekstra=function(t,e,i,n,r,k){a.dataekstraedit.ekstra_id=t,a.dataekstraedit.ekstra_nama=e,a.dataekstraedit.tingkat_id=i,a.dataekstraedit.jurusan_id=n,a.dataekstraedit.guru_id=r,a.dataekstraedit.edit=k;try{a.$apply()}catch(a){}$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.currPg=0,a.dtOptions=i.newOptions().withOption("searching",!0).withOption("drawCallback",(function(t){if(t.aoData.length>0){var e=this.api().page.info();a.currPg=e.start}})).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),t.datakkmtingkat=[],t.getdatakkm=function(){$(".table-responsive").block({}),o.get("proktor/kkmtingkat/data",(function(a){$(".table-responsive").unblock({}),t.datakkmtingkat=a.data}))},0==t.datakkmtingkat.length&&t.getdatakkm()}]);
angular.module("RdmApp").controller("mapelCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,i,o,l,r,n){e.dataEdit={},t.syncronMapel=function(){$.blockUI({}),n.get("proktor/mapel/syncron",(function(e){$.unblockUI({}),e.success?(t.getdataMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1500})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},t.getdataMapel=function(){n.post("proktor/mapel/data",{kurikulum_id:t.kurikulum.kurikulum_id},(function(t){e.dataMapel=t.data,e.MapelInduk=t.induk,e.kelompokmapel=t.kelompok}))},t.getdataMapel(),t.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),n.post("proktor/mapel/save",e.dataEdit,(function(e){$.unblockUI({}),e.success?(t.getdataMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}).then((t=>{t.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},t.dodatamoveUp=function(e){console.log(e),$.blockUI({}),n.post("proktor/mapel/moveup",{mapel_id:e},(function(e){$.unblockUI({}),e.success?(t.getdataMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Nomor Urut Mapel berhasil di naikkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},t.dodatamoveDown=function(e){console.log(e),$.blockUI({}),n.post("proktor/mapel/movedown",{mapel_id:e},(function(e){$.unblockUI({}),e.success?(t.getdataMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Nomor Urut Mapel berhasil di turunkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},t.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((a=>{a.value&&($.blockUI({}),n.post("proktor/mapel/delete",{mapel_id:e},(function(e){$.unblockUI({}),e.success?(t.getdataMapel(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})))}))},t.kurikulum={},t.tambahMapel=function(){""!==t.kurikulum.kurikulum_id?(e.dataEdit={},e.dataEdit.kurikulum_id=t.kurikulum.kurikulum_id,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})):Swal.fire({type:"error",title:"Perhatian",showConfirmButton:!1,html:"Silahkan pilih jenis kurikulum terlebih dahulu",timer:1500})},t.dodataEdit=function(t){e.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:0},{responsivePriority:3,targets:1},{responsivePriority:4,targets:-2}]).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("naikkelasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,n,e,i,l,s,o){a.dtInstance={},a.dtInstance2={},a.dataEdit={},a.datakelasedit={},a.selectAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!0}))},a.clearAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!1}))},a.selectpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!0}))},a.clearpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!1}))},a.prosesNaik=function(){a.filteredArray=a.datasiswaasal.filter((function(a){return 1==a.select}));var t={};t.kelas_id=a.tujuanData.kelas_id,t.tahunajaran_id=a.tujuanData.tahunajaran_id,t.tingkat_id=a.tujuanData.tingkat_id,t.data=a.filteredArray,$.blockUI({}),o.post("proktor/naikkelas/save",t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),a.reloadTableTujuan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.dismiss===Swal.DismissReason.timer&&(a.reloadTable(),a.reloadTableTujuan())}))}))},a.batalNaik=function(){a.filteredArray=a.datasiswatujuan.filter((function(a){return 1==a.select}));var t={};t.kelas_id=a.selectData.kelas_id,t.tahunajaran_id=a.selectData.tahunajaran_id,t.tingkat_id=a.selectData.tingkat_id,t.data=a.filteredArray,$.blockUI({}),o.post("proktor/naikkelas/batalnaik",t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),a.reloadTableTujuan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&(a.reloadTable(),a.reloadTableTujuan())}))}))},t.datasiswaasal=[],a.reloadTable=function(){t.datasiswaasal=[],""!==a.selectData.kelas_id&&($.blockUI({}),o.post("proktor/naikkelas/data",a.selectData,(function(a){$.unblockUI({}),t.datasiswaasal=a.data})))},t.datasiswatujuan=[],a.reloadTableTujuan=function(){t.datasiswatujuan=[],""!==a.tujuanData.kelas_id&&($.blockUI({}),o.post("proktor/naikkelas/data",a.tujuanData,(function(a){$.unblockUI({}),t.datasiswatujuan=a.data})))},a.saveeditkelas=function(){$(".edit-modal").modal("hide"),$.blockUI({}),console.log(a.datakelasedit),o.post("proktor/naikkelas/savekelas",a.datakelasedit,(function(t){$.unblockUI({}),t.success?(a.getdatatingkat(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.datakelasedit={},a.dodataEdit=function(){a.datakelasedit={},a.datakelasedit.tingkat_id=a.tujuanData.tingkat_id,a.datakelasedit.tahunajaran_id=t.tujuanajaran.tahunajaran_id,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.changeTingkat=function(){a.tujuanData.tingkat_id=parseInt(a.selectData.tingkat_id)+1+"",a.selectData.kelas_id="",a.tujuanData.kelas_id="",t.datasiswaasal=[],t.datasiswatujuan=[]},a.currPg=0,a.recordsDisplay=0,a.currPg2=0,a.recordsDisplay2=0,a.tujuanData={},a.tujuanData.kelas_id="",a.tujuanData.tingkat_id="",a.tujuanData.tahunajaran_id="",a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.selectData.tahunajaran_id="",a.dtOptions=e.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("stateSave",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg=n.start,a.recordsDisplay=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg2=n.start,a.recordsDisplay2=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.getdatatingkat=function(){o.get("proktor/naikkelas/datatingkat",(function(n){t.asalajaran=n.asalajaran,t.tujuanajaran=n.tujuanajaran,t.tujuantingkat=n.tujuantingkat,t.tujuankelas=n.tujuankelas,a.tujuanData.tahunajaran_id=t.tujuanajaran.tahunajaran_id,a.selectData.tahunajaran_id=t.asalajaran.tahunajaran_id,a.lastkelas=0,angular.forEach(t.tujuantingkat,(function(t){a.lastkelas=t.tingkat_id}))}))},a.getdatatingkat()}]);
angular.module("RdmApp").controller("pembinaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,a,e,o,i,n,r,s){t.dtInstance={},t.selectData={},t.selectData.tingkat_id="",t.dtOptions=o.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:0},{responsivePriority:3,targets:-2},{responsivePriority:4,targets:-3}]).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),t.getdataKoordinator=function(){$(".table-responsive").block({}),s.post("proktor/p5ra/data",{tingkat_id:t.selectData.tingkat_id},(function(t){$(".table-responsive").unblock({}),a.dataKoordinator=t.data}))},t.getdataKoordinator(),t.pilihkoordinator=function(e){console.log(e),t.datakelasedit=a.arrPush(e),t.datakelasedit.edit=!0,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.simpankoordinator=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("proktor/p5ra/simpankoordinator",t.datakelasedit,(function(a){$.unblockUI({}),a.success?(t.getdataKoordinator(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((t=>{t.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},t.hapuskoordinator=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus koordinator proyek kelas ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("proktor/p5ra/hapuspembina",{pembina_id:a.pembina_id},(function(a){$.unblockUI({}),a.success?(t.getdataKoordinator(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))}}]);
angular.module("RdmApp").controller("pengaturanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,l,i,r,n,o){a.validateToken=function(){$(".rechaptcha-modal").modal("hide");var a=$("#formvalidate");console.log(a.serialize()),$.blockUI({}),o.post("proktor/pengaturan/validaterechaptcha",a.serialize(),(function(a){$.unblockUI({}),null!==a&&a.success?(t.getpengaturan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},a.batalRechaptha=function(){$(".rechaptcha-modal").modal("hide"),Swal.fire({type:"warning",title:"Perhatian",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,confirmButtonText:"Ya!",html:"Apakah ada akan membatalkan aktifasi rechaptcha?"}).then((a=>{a.value?t.getpengaturan():$(".rechaptcha-modal").modal("show")}))},a.savetahunajaran=function(){$.blockUI({}),o.post("proktor/pengaturan/save",{tahunajaran_id:t.tahunajaran.aktif,semester_id:t.datasemester.aktif,sistem_penilaian:t.penilaian.system,rechapcha:t.rechaptcha.aktif,key:t.rechaptcha.key,secret:t.rechaptcha.secret,mobile:t.mobile.aktif},(function(a){$.unblockUI({}),null!==a&&a.success?a.validate?($("#rechapthavalidate").html(a.validate),$(".rechaptcha-modal").modal("show")):(t.getpengaturan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))}}]);
angular.module("RdmApp").controller("pindahkelasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,n,i,e,l,s,o,r){a.dtInstance={},a.dtInstance2={},a.dataEdit={},a.selectAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!0}))},a.clearAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!1}))},a.selectpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!0}))},a.clearpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!1}))},a.prosesNaik=function(){a.filteredArray=a.datasiswaasal.filter((function(a){return 1==a.select}));var t={};t.kelas_id=a.tujuanData.kelas_id,t.tingkat_id=a.selectData.tingkat_id,t.data=a.filteredArray,$.blockUI({}),o.post("proktor/pindahkelas/save",t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),a.reloadTableTujuan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},t.datasiswaasal={},a.reloadTable=function(){t.datasiswaasal={},""!==a.selectData.kelas_id&&($.blockUI({}),o.post("proktor/pindahkelas/data",a.selectData,(function(a){$.unblockUI({}),t.datasiswaasal=a.data})))},t.datasiswatujuan={},a.reloadTableTujuan=function(){t.datasiswatujuan={},""!==a.tujuanData.kelas_id&&($.blockUI({}),o.post("proktor/pindahkelas/data",a.tujuanData,(function(a){$.unblockUI({}),t.datasiswatujuan=a.data})))},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.changeTingkat=function(){a.tujuanData.kelas_id="",a.selectData.kelas_id="",t.datasiswatujuan={},t.datasiswaasal={}},a.currPg=0,a.recordsDisplay=0,a.currPg2=0,a.recordsDisplay2=0,a.tujuanData={},a.tujuanData.kelas_id="",a.tujuanData.tingkat_id="",a.tujuanData.tahunajaran_id="",a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.selectData.tahunajaran_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg=n.start,a.recordsDisplay=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg2=n.start,a.recordsDisplay2=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.getdatatingkat=function(){o.get("proktor/pindahkelas/datatingkat",(function(n){t.asalajaran=n.asalajaran,t.tujuanajaran=n.tujuanajaran,t.asaltingkat=n.asaltingkat,t.asalkelas=n.asalkelas,a.tujuanData.tahunajaran_id=t.tujuanajaran.tahunajaran_id,a.selectData.tahunajaran_id=t.asalajaran.tahunajaran_id}))},a.getdatatingkat()}]);
angular.module("RdmApp").controller("pindahsemesterCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,n,i,s,l,r){a.dtInstance={},a.dtInstance2={},a.dataEdit={},a.datakelasedit={},a.selectAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!0}))},a.clearAll=function(){angular.forEach(t.datasiswaasal,(function(a){a.select=!1}))},a.selectpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!0}))},a.clearpAll=function(){angular.forEach(t.datasiswatujuan,(function(a){a.select=!1}))},a.prosesNaik=function(){a.filteredArray=a.datasiswaasal.filter((function(a){return 1==a.select}));var t={};t.kelas_id=a.tujuanData.kelas_id,t.tahunajaran_id=a.tujuanData.tahunajaran_id,t.tingkat_id=a.tujuanData.tingkat_id,t.data=a.filteredArray,$.blockUI({}),r.post("proktor/pindahsemester/save",t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),a.reloadTableTujuan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.dismiss===Swal.DismissReason.timer&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.batalNaik=function(){a.filteredArray=a.datasiswatujuan.filter((function(a){return 1==a.select}));var t={};t.kelas_id=a.selectData.kelas_id,t.tahunajaran_id=a.selectData.tahunajaran_id,t.tingkat_id=a.selectData.tingkat_id,t.data=a.filteredArray,$.blockUI({}),r.post("proktor/pindahsemester/batalnaik",t,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),a.reloadTableTujuan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{a.reloadTable(),a.reloadTableTujuan()}))}))},t.datasiswaasal=[],a.reloadTable=function(){t.datasiswaasal=[],""!==a.selectData.kelas_id&&($.blockUI({}),r.post("proktor/pindahsemester/data",a.selectData,(function(a){$.unblockUI({}),t.datasiswaasal=a.data})))},t.datasiswatujuan=[],a.reloadTableTujuan=function(){t.datasiswatujuan=[],""!==a.tujuanData.kelas_id&&($.blockUI({}),r.post("proktor/pindahsemester/data",a.tujuanData,(function(a){$.unblockUI({}),t.datasiswatujuan=a.data})))},a.saveeditkelas=function(){$(".edit-modal").modal("hide"),$.blockUI({}),console.log(a.datakelasedit),r.post("proktor/pindahsemester/savekelas",a.datakelasedit,(function(t){$.unblockUI({}),t.success?(a.getdatatingkat(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.datakelasedit={},a.dodataEdit=function(){a.datakelasedit={},a.datakelasedit.tingkat_id=a.tujuanData.tingkat_id,a.datakelasedit.tahunajaran_id=t.tujuanajaran.tahunajaran_id,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.changeTingkat=function(){a.tujuanData.tingkat_id=parseInt(a.selectData.tingkat_id)+1+"",a.selectData.kelas_id="",a.tujuanData.kelas_id="",t.datasiswaasal=[],t.datasiswatujuan=[]},a.currPg=0,a.recordsDisplay=0,a.currPg2=0,a.recordsDisplay2=0,a.tujuanData={},a.tujuanData.kelas_id="",a.tujuanData.tingkat_id="",a.tujuanData.tahunajaran_id="",a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.selectData.tahunajaran_id="",a.dtOptions=n.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("stateSave",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var e=this.api().page.info();a.currPg=e.start,a.recordsDisplay=e.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var e=this.api().page.info();a.currPg2=e.start,a.recordsDisplay2=e.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.getdatatingkat=function(){r.get("proktor/pindahsemester/datatingkat",(function(e){t.asalajaran=e.asalajaran,t.tujuanajaran=e.tujuanajaran,t.tujuantingkat=e.tujuantingkat,t.tujuankelas=e.tujuankelas,a.tujuanData.tahunajaran_id=t.tujuanajaran.tahunajaran_id,a.selectData.tahunajaran_id=t.asalajaran.tahunajaran_id,a.lastkelas=0,angular.forEach(t.tujuantingkat,(function(t){a.lastkelas=t.tingkat_id}))}))},a.getdatatingkat()}]);
angular.module("RdmApp").controller("profileCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,o,i,r,s,n,a){e.password={},t.hapusLogo=function(){$.blockUI({}),a.get("proktor/hapuslogo",(function(t){$.unblockUI({}),t.success?(e.getprofile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Logo berhasil dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.savePimpinan=function(){$.blockUI({}),a.post("proktor/savepimpinan",e.pimpinan,(function(t){$.unblockUI({}),t.success?(e.getprofile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.syncProfile=function(){$.blockUI({}),a.post("proktor/syncprofile",e.pimpinan,(function(t){$.unblockUI({}),t.success?(e.getprofile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.savePassword=function(){$.blockUI({}),a.post("proktor/ubahpassword",e.password,(function(t){$.unblockUI({}),t.success?(e.password.password="",e.password.konfirmasi="",Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.browseimage=function(){$("#imageFile").click()},t.$on("pictureInsert",(function(t,o){$("#imageFile").val(null),e.profile.lembaga_foto=o}))}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(t){return{restrict:"A",scope:!0,link:function(e,o,i){o.bind("change",(function(){$.blockUI({});var i=new FormData;i.append("file",o[0].files[0]);var r=o[0].getAttribute("data-url");o[0].getAttribute("image-container");t(r,i,(function(t){$.unblockUI({}),t&&t.success?e.$emit("pictureInsert",t.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.data})}))}))}}}]);
angular.module("RdmApp").controller("raporp5Ctrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(t,a,e,i,o,n,r,s,l){t.dtInstance={},t.dtInstance2={},t.dataEdit={},a.walassiswa={},t.reloadTable=function(){a.walassiswa={},""!==t.selectData.kelas_id&&($.blockUI({}),s.post("proktor/siswa/datasiswa",t.selectData,(function(t){$.unblockUI({}),a.walassiswa=t.data})))},t.selectData={},t.selectData.kelas_id="",t.selectData.tingkat_id="",t.dataproyek={},t.getdataproyek=function(){$.blockUI({}),s.post("proktor/p5ra/datacetak",t.selectData,(function(a){$.unblockUI({}),t.reloadTable(),t.dataproyek=a.data}))},t.batalkirim=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Batalkan!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan pengiriman nilai ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("proktor/p5ra/batalkirimproyek",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.getdataproyek(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil dibatalkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.openNewAjaxTab=function(t){$.ajax({url:base_url+"guru/rapor/validasi",method:"GET",headers:{"Content-type":"application/json"},responseType:"arraybuffer",success:function(a){var e=t,i=document.createElement("a");i.href=e,i.target="_blank",i.download="Testing.pdf",document.body.appendChild(i),i.click(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data download",timer:2e3})},error:function(t){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal download",timer:2e3})}})},t.dodataEdit=function(a){t.dataEdit=a,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers"),t.dtOptions2=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("riwayatsiswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,n,i,s,o,r,e){a.dtInstance={},a.dtInstance2={},a.dataEdit={},a.datakelasedit={},a.reloadTable=function(){t.datasiswatujuan={},t.datasiswaasal={},""!==a.keyword&&($.blockUI({}),e.post("proktor/siswa/caridata",{keyword:a.keyword},(function(a){$.unblockUI({}),t.datasiswaasal=a.data})))},a.keyword="",a.selectSiswa="",a.showriwayat=function(n){a.selectSiswa=n,$.blockUI({}),e.post("proktor/siswa/datariwayat",{siswa_id:a.selectSiswa},(function(a){$.unblockUI({}),t.datasiswatujuan=a.data}))},a.currPg=0,a.recordsDisplay=0,a.currPg2=0,a.recordsDisplay2=0,a.dtOptions=i.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("stateSave",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg=n.start,a.recordsDisplay=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("paging",!0).withOption("processing",!0).withOption("columnDefs",[{orderable:!1,targets:0}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var n=this.api().page.info();a.currPg2=n.start,a.recordsDisplay2=n.recordsDisplay}})).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]),a.getdatatingkat=function(){e.get("proktor/pindahsemester/datatingkat",(function(n){t.asalajaran=n.asalajaran,t.tujuanajaran=n.tujuanajaran,t.tujuantingkat=n.tujuantingkat,t.tujuankelas=n.tujuankelas,a.tujuanData.tahunajaran_id=t.tujuanajaran.tahunajaran_id,a.selectData.tahunajaran_id=t.asalajaran.tahunajaran_id,a.lastkelas=0,angular.forEach(t.tujuantingkat,(function(t){a.lastkelas=t.tingkat_id}))}))},a.getdatatingkat()}]);
angular.module("RdmApp").controller("semesterCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(e,t,r,o,s,l,a,i){e.savesemester=function(){$.blockUI({}),i.post("proktor/semester/save",{aktif:t.datasemester.aktif},(function(e){$.unblockUI({}),null!==e&&e.success?(t.getsemester(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==e?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))}}]);
angular.module("RdmApp").filter("filterSiswa",(function(){return function(a,e){var s=[];return void 0===e||""===e||angular.forEach(a,(function(a){1*a.rombel==1*e&&s.push(a)})),s}})),angular.module("RdmApp").controller("siswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,s,i,t,l,o,n,m){a.dtInstance={},a.dataEdit={},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),n.post("proktor/siswa/save",a.dataEdit,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dataMutasi={},a.dodataMutasi=function(e){a.dataMutasi=e,$(".mutasi-modal").modal("show")},a.prosesMutasi=function(e){$(".mutasi-modal").modal("hide"),Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, mutasi!",showCancelButton:!0,html:"Apakah Anda yakin akan memutasi siswa ini?"}).then((e=>{e.value&&($.blockUI({}),n.post("proktor/siswa/mutasi",a.dataMutasi,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Siswa Berhasil Dimutasi",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})))}))},a.detailUpload=[],e.datasiswa={},a.reloadTable=function(){e.datasiswa={},""!==a.selectData.kelas_id&&e.getdatasiswa(a.selectData)},a.simpanEmisKelas=function(){$(".syncemis-modal").modal("hide"),$.blockUI({message:"<h4>Meyimpan data Siswa</h4>"}),a.kirimdata={},a.kirimdata.tingkat_id=a.selectData.tingkat_id,a.kirimdata.kelas_id=a.emisKelas.kelas_id,a.kirimdata.siswa=[];var e,s=0,i=!0;angular.forEach(a.tempEmis,(function(t){i&&t.rombel==a.emisKelas.rombel&&(""==t.siswa_nis&&(i=!1,e=t.siswa_nama),a.kirimdata.siswa[s]=t,s++)})),i?n.post("proktor/siswa/simpanEmis",a.kirimdata,(function(e){$.unblockUI(),e.success?(a.reloadTable(),angular.forEach(e.siswa,(function(e){angular.forEach(a.tempEmis,(function(s,i){e.siswa_emis==s.siswa_emis&&(e.success?(a.tempEmis.splice(i,1),console.log(i+" Deleted")):(s.success=e.success,s.keterangan=e.message))}))})),Swal.fire({type:"success",title:"Berhasil",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,html:"Data Berhasil Disimpan"}).then((a=>{a.value&&$(".syncemis-modal").modal("show")}))):Swal.fire({type:"error",title:"Gagal",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".syncemis-modal").modal("show")}))})):($.unblockUI(),Swal.fire({type:"error",title:"Gagal",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,html:"Siswa atas nama "+e+" belum memiliki nis lokal, silahkan lengkapi terlebih dahulu"}).then((a=>{a.value&&$(".syncemis-modal").modal("show")}))),console.log(a.kirimdata.siswa)},a.syncEmisRombel=function(){a.siswaRombelEmis=a.rombelEmis[a.emisKelas.rombel].siswa,console.log(a.rombelEmis[a.emisKelas.rombel].siswa.length),a.siswaRombelEmis.sort((function(a,e){return a.siswa_absen-e.siswa_absen})),console.log(a.siswaRombelEmis.length),a.getdatasiswa(0)},a.getdatasiswa=function(e){e<a.siswaRombelEmis.length?(data=a.siswaRombelEmis[e],data.success?a.getdatasiswa(e+1):(a.siswaRombelEmis[e].process="1",$("#syncSiswaRombel").block({message:"<h4>Proses syncron data "+(e+1)+" dari "+a.siswaRombelEmis.length+"</h4>"}),n.post("proktor/siswa/syncdatasiswaemis/"+a.emisKelas.kelas_id,data,(function(s){$("#syncSiswaRombel").unblock(),s.success?(a.siswaRombelEmis[e]=$.extend({},a.siswaRombelEmis[e],s.data),a.getdatasiswa(e+1),a.siswaRombelEmis[e].process="0",a.siswaRombelEmis[e].show=!0):(null!=s.data?(a.siswaRombelEmis[e]=$.extend({},a.siswaRombelEmis[e],s.data),a.siswaRombelEmis[e].show=!0):a.siswaRombelEmis[e].show=!1,a.siswaRombelEmis[e].process="0",void 0!==s.message?a.siswaRombelEmis[e].message=s.message:a.siswaRombelEmis[e].message="Gagal terhubung ke server",a.getdatasiswa(e+1))})))):a.reloadTable()},a.syncSiswaEmis=function(e){$.blockUI({message:"<h4>Proses syncron data "+e.siswa_nama+"</h4>"}),n.post("proktor/siswa/syncsiswaemis",e,(function(s){$.unblockUI(),s.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:"Data "+e.siswa_nama+" berhasil di Syncron dengan data emis",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:s.message})}))},a.doSyncEmis=function(){$.blockUI({message:"<h4>Verifikasi data tahun ajaran</h4>"}),n.post("proktor/chekTaEmis",a.selectData,(function(e){if($.unblockUI(),e.success){var s=e.Emis.id;a.tempEmis=[],a.emisRombel=e.rombel,a.rombelEmis=[],a.tmprombelEmis=[],a.dataNew=!1,a.newsync=0,a.emisKelas={},a.emisKelas.kelas_id=a.selectData.kelas_id,a.processSyncSiswa(1,s)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.doSyncRombel=function(){a.siswaRombelEmis=[],$.blockUI({message:"<h4>Verifikasi data tahun ajaran</h4>"}),n.post("proktor/chekTaEmis",a.selectData,(function(e){if($.unblockUI(),e.success){var s=e.Emis.id;a.tempEmis=[],a.emisRombel=e.rombel,a.rombelEmis=[],a.tmprombelEmis=[],a.dataNew=!1,a.newsync=0,a.emisKelas={},a.emisKelas.kelas_id="",a.emisKelas.rombel="",a.processSyncRombel(1,s)}else Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.processSyncRombel=function(s,i){$.blockUI({message:"<h4>Syncron Data Rombel Emis Halaman "+s+"</h4>"}),n.post("proktor/siswa/syncRombelEmis/"+e.emisLembagaid,{page:s,ta:i},(function(e){$.unblockUI(),e.success?(e.data.length>0&&angular.forEach(e.data,(function(e,s){a.rombelEmis.push(e)})),!1!==e.next?a.processSyncRombel(e.next,i):$(".syncrombelemis-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.tempEmis=[],a.tmprombelEmis=[],a.rombelEmis=[],a.dataNew=!1,a.newsync=0,a.processSyncSiswa=function(s,i){$.blockUI({message:"<h4>Syncron Data Emis Halaman "+s+"</h4>"}),n.post("proktor/siswa/syncEmis/"+e.emisLembagaid,{page:s,ta:i},(function(e){$.unblockUI(),e.success?(e.data.length>0&&angular.forEach(e.data,(function(e,s){a.dataNew=!0,a.tempEmis.push(e),a.tmprombelEmis.includes(1*e.rombel)||(a.tmprombelEmis.push(1*e.rombel),a.FilPilihan=a.emisRombel.filter((function(a){return 1*a.rombel==1*e.rombel})),a.FilPilihan.length>0?a.rombelEmis.push(a.FilPilihan[0]):a.rombelEmis.push({tingkat_id:e.tingkat_id,rombel:e.rombel}))})),a.newsync+=e.update.length,console.log(a.tmprombelEmis),!1!==e.next?a.processSyncSiswa(e.next,i):a.dataNew?(console.log(a.rombelEmis),$(".syncemis-modal").modal("show")):Swal.fire({type:"success",title:"Berhasil Syncron",showConfirmButton:!1,html:a.newsync+" siswa emis berhasil di Syncron",timer:2e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.emisKelas={},a.emisKelas.kelas_id="",a.emisKelas.rombel="",a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.chekEmisData=function(){$.blockUI({message:"<h4>Chek data NISN "+a.dataEmis.nisn+"</h4>"}),n.post("proktor/siswa/cheknisn",a.dataEmis,(function(e){$.unblockUI(),e.success?($(".emis-modal").modal("hide"),a.dataEdit=e.data,a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},a.doemisTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEmis={},a.dataEmis.nisn="",a.dataEmis.kelas_id=a.selectData.kelas_id,a.dataEmis.tingkat_id=a.selectData.tingkat_id,$(".emis-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.clearKelas=function(s){a.selectData.kelas_id="",e.datasiswa={}},a.dodataEdit=function(e){a.dataEdit=e,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5,6,7]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Data Siswa","RDM")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5,6,7]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:4},{responsivePriority:3,targets:2},{responsivePriority:4,targets:3}]).withOption("responsive",!0).withOption("paging",!0).withOption("stateSave",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var r=a.uploader=new m({url:base_url+"proktor/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){r.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},r.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),r.filters.push({name:"imageFilter",fn:function(a,e){var s="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",s),-1!=="|xls|xlsx|".indexOf(s)}}),r.onSuccessItem=function(e,s,i,t){a.detailUpload=s.siswa,a.berhasilka=a.berhasilka+s.sukses,a.gandaaa=a.gandaaa+s.double1,a.gagalaa=a.gagalaa+s.gagal,a.$apply(),console.info("onSuccessItem",e,s,i,t,a.gandaaa)},r.onCompleteAll=function(){a.reloadTable()},r.onBeforeUploadItem=function(e){a.detailUpload=[],e.url=base_url+"proktor/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},r.onAfterAddingAll=function(a){r.uploadAll()}}]);
angular.module("RdmApp").controller("statusnilaiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,i,e,l,n,o,s,d){a.dtInstance={},a.dataEdit={},a.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((i=>{i.value&&($.blockUI({}),s.post("proktor/siswa/delete",{siswa_id:t},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},t.walasnilai={},t.getwalasnilai=function(){""!==t.walas&&($.blockUI({}),s.get("proktor/datanilai/"+a.selectData.tingkat_id+"/"+a.selectData.kelas_id,(function(a){$.unblockUI({}),t.walasnilai=a.data,t.walaskirim=a.kirim,t.nilailock=a.nilailock,t.rekapkelas=a.rekapkelas})))},a.reloadTable=function(){t.walasnilai={},t.walaskirim={},""!==a.selectData.tingkat_id&&t.getwalasnilai()},a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.clearKelas=function(i){a.selectData.kelas_id="",t.walasnilai={},a.reloadTable()},a.locknilai=function(i){""!==t.walas&&($.blockUI({}),s.post("proktor/locknilai/"+a.selectData.kelas_id,{status:i},(function(a){$.unblockUI({}),t.getwalasnilai()})))},a.lockkelas=function(a,i){let e="";e=0==a?"Apakah anda yakin akan membuka kunci nilai kelas "+i.kelas+"?":"Apakah anda yakin akan mengunci nilai kelas "+i.kelas+"?",Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya",showCancelButton:!0,html:e}).then((e=>{e.value&&($.blockUI({}),s.post("proktor/locknilai/"+i.kelas_id,{status:a},(function(a){$.unblockUI({}),t.getwalasnilai()})))}))},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("tahunajaranCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,n,r,o,l,i){a.savetahunajaran=function(){$.blockUI({}),i.post("proktor/tahunajaran/save",{aktif:t.tahunajaran.aktif},(function(a){$.unblockUI({}),null!==a&&a.success?(t.gettahunajaran(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))}}]);
angular.module("RdmApp").controller("targetp5Ctrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(e,t,i,a,n,s,o,r){e.dtInstance={},e.selectData={},e.selectData.dimensi_id="",e.selectData.elemen_id="",e.selectData.subelemen_id="",e.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(e){t.customepdf(e,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:0},{responsivePriority:3,targets:-2},{responsivePriority:4,targets:-3}]).withOption("responsive",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers"),e.getdatap5ra=function(){$(".table-responsive").block({}),r.post("proktor/p5ra/datap5ra",{dimensi_id:e.selectData.dimensi_id,elemen_id:e.selectData.elemen_id,subelemen_id:e.selectData.subelemen_id},(function(i){$(".table-responsive").unblock({}),t.dimensi=i.dimensi,t.elemen=i.elemen,t.subelemen=i.subelemen,e.getdatatargetp5ra()}))},e.getdatatargetp5ra=function(){$(".table-responsive").block({}),r.post("proktor/p5ra/targetp5ra",{dimensi_id:e.selectData.dimensi_id,elemen_id:e.selectData.elemen_id,subelemen_id:e.selectData.subelemen_id},(function(e){$(".table-responsive").unblock({}),t.datap5ra=e.data}))},e.getdatap5ra(),e.syncronp5ra=function(){$.blockUI({}),r.get("proktor/p5ra/syncronp5ra",(function(t){$.unblockUI({}),t.success?(e.getdatap5ra(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((e=>{}))}))}}]);
