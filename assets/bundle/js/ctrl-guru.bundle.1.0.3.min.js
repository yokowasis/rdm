

angular.module("RdmApp").controller("DashboardCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,o,a,i,r,n,l){t.editProfile=function(){$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.getdashboard=function(){l.get("guru/dashboard",(function(t){e.dashboard=t.data}))},t.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("guru/saveprofile",e.profile,(function(t){$.unblockUI({}),t.success?(e.getprofile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".edit-modal").modal("show")}))}))},t.getdashboard(),t.browseimage=function(){$("#imageFile").click()},t.$on("pictureInsert",(function(t,o){e.profile.guru_foto=o}))}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(t){return{restrict:"A",scope:!0,link:function(e,o,a){o.bind("change",(function(){$.blockUI({});var a=new FormData;a.append("file",o[0].files[0]);var i=o[0].getAttribute("data-url");o[0].getAttribute("image-container");t(i,a,(function(t){$.unblockUI({}),t&&t.success?e.$emit("pictureInsert",t.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.data})}))}))}}}]);
angular.module("RdmApp").controller("absenCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,n,t,s,l,o,e){a.dtInstance={},i.knilai={},i.sakitAll={},i.ijinAll={},i.aplaAll={},a.setsakitAll=function(a){null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.sakit=a}))},a.setijinAll=function(a){console.log(a),null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.ijin=a}))},a.setalpaAll=function(a){null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.alpa=a}))},a.tambahpas=function(){i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.simpanAbsen=function(){i.knilai={},i.knilai.absen=[],angular.forEach(i.walassiswa,(function(a){var n={};n.siswa_id=a.siswa_id,n.sakit=a.absen.sakit,n.ijin=a.absen.ijin,n.alpa=a.absen.alpa,i.knilai.absen.push(n)})),$(".edit-modal").modal("hide"),$.blockUI({}),e.post("guru/walas/saveabsen/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".edit-modal").modal("show")}))}))},a.dtOptions=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("berandaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,i,l,n,s,o){void 0!==t.datakelas[t.selectKelas]?void 0!==t.datakelas[t.selectKelas].bahanajar?t.bahanajar=t.datakelas[t.selectKelas].bahanajar:t.datakelas[t.selectKelas].timeline=[]:(t.posts=[],t.datakelas[t.selectKelas]=[],t.datakelas[t.selectKelas].bahanajar=[]),a.dtInstance={},a.currPg=0,a.recordsDisplay=0,a.tambahsiswapilihan=function(){$(".tambah-modal").modal("show")},a.chselectAll=function(t){angular.forEach(a.datapilihan,(function(a){a.select=t}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{console.log(e),e.value&&($.blockUI({}),o.post("guru/kelas/deletepilihan/"+t.selectKelas,{siswa_id:a},(function(a){$.unblockUI({}),a.success?(t.getharian(),t.getketerampilan(),t.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.knilai={},a.savedatapilihan=function(){$(".tambah-modal").modal("hide"),t.knilai.kirimnilai=[],$i=0,t.knilai.selectKelas=t.selectKelas,angular.forEach(t.datapilihan,(function(a){if("0"!==a.select){var e={};e.siswa_id=a.siswa_id,t.knilai.kirimnilai[$i]=e,$i++}})),$.blockUI({}),o.post("guru/kelas/savepilihan",t.knilai,(function(a){$.unblockUI({}),null!==a&&a.success?(t.getharian(),t.getketerampilan(),t.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))},a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("AutoWidth",!0).withOption("responsive",!0).withOption("columnDefs",[{width:"2%",targets:0},{width:"10%",targets:-2},{width:"16%",targets:-1},{responsivePriority:1,targets:2},{responsivePriority:2,targets:-1}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var e=this.api().page.info();a.currPg=e.page,a.recordsDisplay=e.recordsDisplay,console.log(a.currPg)}$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("bobotCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,a,e,i,s,o,l,n){void 0!==a.datakelas[a.selectKelas]?void 0!==a.datakelas[a.selectKelas].bahanajar?a.bahanajar=a.datakelas[a.selectKelas].bahanajar:a.datakelas[a.selectKelas].timeline=[]:(a.posts=[],a.datakelas[a.selectKelas]=[],a.datakelas[a.selectKelas].bahanajar=[]),t.dtInstance={},t.currPg=0,t.recordsDisplay=0,t.savedataBobot=function(){$.blockUI({}),n.post("guru/kelas/savebobot/"+a.selectKelas,a.bobot,(function(t){$.unblockUI({}),null!==t&&t.success?(a.getbobotkelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("AutoWidth",!0).withOption("responsive",!0).withOption("columnDefs",[{width:"2%",targets:0},{width:"10%",targets:-2},{width:"16%",targets:-1},{responsivePriority:1,targets:2},{responsivePriority:2,targets:-1}]).withOption("drawCallback",(function(a){if(a.aoData.length>0){var e=this.api().page.info();t.currPg=e.page,t.recordsDisplay=e.recordsDisplay}$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("catatanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(i,a,t,n,o,s,e,l,p){a.knilai={},i.tambahpas=function(){a.knilai.edit=!1,$(".edit-modal").modal("show")},i.simpanCatatan=function(){a.knilai={},a.knilai.absen=[],angular.forEach(a.walassiswa,(function(i){var t={};t.siswa_id=i.siswa_id,t.catatan=i.absen.catatan,a.knilai.absen.push(t)})),$(".edit-modal").modal("hide"),$.blockUI({}),l.post("guru/walas/savecatatan/"+a.walas,a.knilai,(function(i){$.unblockUI({}),i.success?(a.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((i=>{i.value&&$(".edit-modal").modal("show")}))}))},i.dtOptions=n.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),i.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("datakelasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,i,l,o,s,d){t.dtInstance={},t.datakelasedit={},t.saveeditkelas=function(){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("guru/kelas/save",t.datakelasedit,(function(t){$.unblockUI({}),t.success?(e.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".edit-modal").modal("show")}))}))},t.editkelas=function(e,a,i,l,o,s){t.datakelasedit.kelas_id=e,t.datakelasedit.kelas_nama=a,t.datakelasedit.tingkat_id=i,t.datakelasedit.jurusan_id=l,t.datakelasedit.guru_id=o,t.datakelasedit.edit=s;try{t.$apply()}catch(t){}$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("ekstraCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,l,n,s,o,r){a.selectData={},a.selectAll="0",a.selectData.kelas_id="",t.datasiswaextra={},a.tingkatChange=function(){a.datasiswaextra={},a.siswaextra={},a.selectData.kelas_id=""},a.chselectAll=function(t){angular.forEach(a.siswaextra,(function(a){a.select=t}))},a.tambahpas=function(){t.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.getdatatingkat=function(){o.get("guru/extra/datatingkat",(function(a){t.tingkat=a.tingkat,t.jurusan=a.jurusan,t.kelas=a.kelas}))},t.getdatatingkat(),a.datasiswaextra=[],a.tambahsiswapilihan=function(){$(".tambah-modal").modal("show")},a.savedatapilihan=function(){$(".tambah-modal").modal("hide"),t.knilai={},t.knilai.kirimnilai=[],$i=0,t.knilai.extra=t.extra,t.knilai.kelas_id=a.selectData.kelas_id,angular.forEach(a.siswaextra,(function(a){if("0"!==a.select){var e={};e.siswa_id=a.siswa_id,t.knilai.kirimnilai[$i]=e,$i++}})),$.blockUI({}),o.post("guru/extra/savepilihan",t.knilai,(function(t){$.unblockUI({}),null!==t&&t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))},a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus siswa ini dari binaan anda?"}).then((i=>{i.value&&($.blockUI({}),o.post("guru/extra/deletepilihan",{siswa_id:e,ekstrakurikuler_id:t.extra,kelas_id:a.selectData.kelas_id},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},a.simpanExtra=function(){t.knilai={},t.knilai.extra=[],angular.forEach(a.datasiswaextra,(function(e){var i={};i.siswa_id=e.siswa_id,i.kelas_id=a.selectData.kelas_id,i.nilaiextra=e.nilaiextra,t.knilai.extra.push(i)})),$(".edit-modal").modal("hide"),$.blockUI({}),o.post("guru/extra/simpanextra/"+t.extra,t.knilai,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&$(".edit-modal").modal("show")}))}))},a.siswaextra={},a.reloadTable=function(){""!==t.extra&&($.blockUI({}),a.datasiswaextra={},a.selectData.ekstrakurikuler_id=t.extra,o.post("guru/extra/datasiswa",a.selectData,(function(e){$.unblockUI({}),a.datasiswaextra=e.data,a.siswaextra=e.siswa,t.extranilailock=e.nilailock})))},a.dtOptions=i.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Kelas Kosong",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1500}):(t.knilai={},t.knilai.edit=!1,$(".upload-modal").modal("show"))};var u=a.uploader=new r({url:base_url+"guru/extra/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){u.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},u.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),u.onSuccessItem=function(t,e,i,l){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,l,a.gandaaa)},u.onCompleteAll=function(){a.reloadTable()},u.onBeforeUploadItem=function(e){e.url=base_url+"guru/extra/importnilai/"+t.extra+"/"+a.selectData.kelas_id},u.onAfterAddingAll=function(a){u.uploadAll()}}]);
angular.module("RdmApp").controller("forumCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","nowTime",function(t,e,o,n,s,i,u,r,a){t.nowTime=a,t.row=0,t.rowperpage=3,t.newPost={},t.newKomen={},t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,t.busy=!1,t.loading=!1,t.setType=function(e){t.newPost.type=e},t.saveComent=function(e,o){$.blockUI({}),t.newKomen={},t.newKomen.forumrespon_komentar=o,t.newKomen.forum_id=e.forum_id,r.post("guru/forum/savekomen",t.newKomen,(function(o){$.unblockUI({}),o.success?(t.updatePosts(e),t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:o.message})}))},t.browseimage=function(){$("#imageFile").click()},t.removeImage=function(){t.newPost.image=""},t.sendPost=function(){$.blockUI({}),r.post("guru/forum/save",t.newPost,(function(e){$.unblockUI({}),e.success?(t.getnewPosts(),t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},t.getnewPosts=function(){t.posts.length>0&&(forum_id=e.posts[0].forum_id),r.get("guru/forum/newdata/"+forum_id,(function(o){o.success&&(t.row+=t.rowperpage,t.$apply((function(){angular.forEach(o.data,(function(t){e.posts.unshift(t)})),setTimeout((function(){$(".lazy").Lazy()}),1e3)})))}))},t.updatePosts=function(t){$.blockUI({}),forum_id=t.forum_id,r.get("guru/forum/getupdatedata/"+forum_id,(function(o){if($.unblockUI({}),o.success){t=o.data;const n=e.posts.findIndex((t=>t.forum_id===o.data.forum_id));e.posts[n]=o.data}}))},t.getPosts=function(){t.busy||(t.loading=!0,t.busy=!0,forum_id="0",e.posts.length>0&&(forum_id=e.posts[e.posts.length-1].forum_id),r.get("guru/forum/data/"+forum_id,(function(o){o.success?(t.row+=t.rowperpage,t.$apply((function(){angular.forEach(o.data,(function(t){e.posts.push(t)})),t.busy=!1,t.loading=!1,setTimeout((function(){$(".lazy").Lazy()}),1e3)}))):(t.busy=!1,t.loading=!1)})))},t.$on("pictureInsert",(function(e,o){t.newPost.image=o})),0==e.posts.length&&t.getPosts(),$("#postText").focus()}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(t){return{restrict:"A",scope:!0,link:function(e,o,n){o.bind("change",(function(){$.blockUI({});var n=new FormData;n.append("file",o[0].files[0]);var s=o[0].getAttribute("data-url");o[0].getAttribute("image-container");t(s,n,(function(t){$.unblockUI({}),t&&t.success?e.$emit("pictureInsert",t.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.data})}))}))}}}]);
angular.module("RdmApp").controller("guruCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,o,n,i,l,r,s){a.dtInstance={},a.datakelasedit={},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("proktor/guru/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getdataguru(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{e.value&&($.blockUI({}),r.post("proktor/guru/delete",{guru_id:a},(function(a){$.unblockUI({}),a.success?(t.getdataguru(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.dodataUpload=function(){$(".upload-modal").modal("show")},a.dodataTambah=function(){a.dataEdit={},a.dataEdit.edit=!1},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=o.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var d=a.uploader=new s({url:base_url+"proktor/guru/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),d.onSuccessItem=function(t,e,o,n){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,o,n,a.gandaaa)},d.onCompleteAll=function(){t.getdataguru()},d.onBeforeUploadItem=function(a){a.url=base_url+"proktor/guru/import"},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("harianCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataharian,(function(n){null!==n.nilai&&void 0!==n.nilai[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilai[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,i.knilai.komponennilai_materi="",i.knilai.komponennilai_nama="",i.knilai.tambahharian={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(i){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("guru/pengetahuan/deleteharian",i,(function(i){$.unblockUI({}),a.getharian(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("guru/pengetahuan/saveharian",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getharian(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var h=a.uploader=new s({url:base_url+"guru/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){h.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},h.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),h.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),h.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},h.onCompleteAll=function(){i.getharian()},h.onBeforeUploadItem=function(a){a.url=base_url+"guru/pengetahuan/importnilai/harian/"+i.selectKelas},h.onAfterAddingAll=function(a){h.uploadAll()}}]);
angular.module("RdmApp").controller("kelasCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,n,o,l,e,t,k,p,r){n.dataharian=[],n.dataketerampilan=[],n.bobot=[],n.kkmdata=[],n.selectKelas=o.idkelas,a.put("selectkelas",n.selectKelas),n.getbobotkelas=function(){r.get("guru/kelas/bobot",(function(a){n.kkmdata=a.data,n.bobot=a.bobot,0==n.kkmdata.length?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"KKM Tingkat belum di isi oleh admin madrasah."}):(n.getharian(),n.getketerampilan())}))},n.getbobotkelas(),n.updateSikap=function(){"0"!==n.datakelasSelect.mapel_jenisnilai&&void 0!==n.datakelasSelect.mapel_jenisnilai&&i.getSikap(n.datakelasSelect.mapel_jenisnilai)},i.getSikap=function(a){$.blockUI({}),r.get("guru/sikap/datasikap/"+a,(function(a){$.unblockUI({}),n.datasikap=[],n.datakomponensikap=a.komponen,n.datanilaisikap=a.datanilai,n.jenisnilai=a.jenisnilai,angular.forEach(n.datasiswa,(function(a){var o=!1;"1"==n.datakelasSelect.mapel_pilihan&&(i.FilPilihan=n.siswapilihan.filter((function(i){return i.siswa_id==a.siswa_id})),i.FilPilihan.length>0&&(o=!0)),"0"!=n.datakelasSelect.mapel_pilihan&&1!=o||n.datasikap.push(a)})),n.jnilai=0,angular.forEach(n.jenisnilai,(function(a){a.cnilai>0&&n.jnilai++}))}))},i.filterKelas=function(){n.datakelasSelect=[],i.filterdata=n.datakelas.filter((function(a){return a.ajar_id==n.selectKelas})),i.filterdata.length>0&&(n.datakelasSelect=i.filterdata[0])},i.filterKelas(),i.$on("KelasChange",(function(a,n){n.length>0&&i.filterKelas()})),i.getdatasiswa=function(){r.get("guru/kelas/datasiswa",(function(a){n.datasiswa=a.data}))},i.getdatasiswa(),n.dataRapor={},n.dataRapork={},n.getharian=function(){$.blockUI({}),r.get("guru/pengetahuan/harian",(function(a){$.unblockUI({}),n.dataharian=[],n.datapilihan=[],n.datakomponen=a.komponen,n.datanilai=a.datanilai,n.datapas=a.datapas,n.dataRapor=a.datarapor,n.siswapilihan=a.siswapilihan,n.nilailock=a.nilailock,angular.forEach(n.datasiswa,(function(a){var o=!1;if("1"==n.datakelasSelect.mapel_pilihan&&(i.FilPilihan=n.siswapilihan.filter((function(i){return i.siswa_id==a.siswa_id})),i.FilPilihan.length>0&&(o=!0)),"0"==n.datakelasSelect.mapel_pilihan||1==o){var l=0,e="",t="",k=100;if(console.log("Paspat"),void 0!==n.datapas[a.siswa_id]?a.paspat=parseInt(n.datapas[a.siswa_id]):(a.paspat="",n.bobot.bobotkelas.paspat>0&&(k=0)),console.log(a.paspat),void 0!==n.datanilai[a.siswa_id]){a.nilai=n.datanilai[a.siswa_id];var p=0;angular.forEach(n.datakomponen,(function(i){var n;(n=void 0!==a.nilai[i.komponennilai_id]?parseInt(a.nilai[i.komponennilai_id]):0)>l&&(l=n,e=i.komponennilai_materi),n<k&&(k=n,t=i.komponennilai_materi),p+=n})),a.nilaiharian=Math.round(p/n.datakomponen.length,0)}else a.nilai=null,a.nilaiharian=0,n.bobot.bobotkelas.harian>0&&(k=0),n.bobot.bobotkelas.paspat>0&&(k=0);if(void 0!==n.dataRapor[a.siswa_id])a.rapor=n.dataRapor[a.siswa_id].rapor_nilai,a.predikat=n.dataRapor[a.siswa_id].rapor_predikat,a.desc=n.dataRapor[a.siswa_id].rapor_deskripsi;else if(a.nilaiharian+a.paspat>0?a.rapor=Math.round((a.nilaiharian*n.bobot.bobotkelas.harian+a.paspat*n.bobot.bobotkelas.paspat)/(n.bobot.bobotkelas.harian+n.bobot.bobotkelas.paspat),2):a.rapor=0,i.FilPredikat=n.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapor&&parseInt(i.kkmgrade_max)>=a.rapor})),i.FilPredikat.length>0){a.predikat=i.FilPredikat[0].kkmgrade_kode;var r=parseInt(n.kkmdata.kkmtingkat_nilai),d="";d="A"==a.predikat?"sangat baik":"B"==a.predikat?"baik":"C"==a.predikat?"cukup baik":"belum optimal",r<=k&&r<=l&&r<=a.rapor?a.desc="Memiliki kemampuan "+d+" terutama kemampuan dalam "+e:r<=k&&r<=l&&r>a.rapor?a.desc=k==l?"Memiliki kemampuan "+d+" pada seluruh materi terutama dalam "+e:"Memiliki kemampuan "+d+". Memiliki kemampuan baik dalam "+e+", dan perlu ditingkatkan dalam "+t:a.desc=r>k&&k>0&&r<=l?k==l?"Memiliki kemampuan "+d+" pada seluruh materi terutama dalam "+t:"Memiliki kemampuan "+d+". Memiliki kemampuan baik dalam "+e+", dan perlu ditingkatkan dalam "+t:"Memiliki kemampuan belum optimal pada seluruh materi",0==a.rapor&&(a.desc="")}else a.predikat="-",a.desc="";console.log("Harian Siswa"),console.log(a),n.dataharian.push(a)}else a.select="0",n.datapilihan.push(a)}))}))},i.nilaikd=[],n.getketerampilan=function(){r.get("guru/keterampilan/dataketerampilan",(function(a){n.dataketerampilan=[],n.komponenuk=a.komponenuk,n.datauk=a.datauk,n.komponenpro=a.komponenpro,n.datapro=a.datapro,n.komponenpor=a.komponenpor,n.datapor=a.datapor,n.dataRapork=a.datarapork,n.siswapilihank=a.siswapilihan,angular.forEach(n.datasiswa,(function(a){var o=!1;if(i.nilaikd=[],i.finalkd=[],"1"==n.datakelasSelect.mapel_pilihan&&(i.FilPilihank=n.siswapilihank.filter((function(i){return i.siswa_id==a.siswa_id})),i.FilPilihank.length>0&&(o=!0)),"0"==n.datakelasSelect.mapel_pilihan||1==o){var l=0,e=100;if(a.uknilai=[],void 0!==n.datauk[a.siswa_id]){a.nilaiuk=n.datauk[a.siswa_id];var t=0;angular.forEach(n.komponenuk,(function(o){var k;void 0!==a.nilaiuk[o.komponennilai_id]?(k=parseInt(a.nilaiuk[o.komponennilai_id]),a.uknilai[o.komponennilai_nama]=k):(k=0,a.uknilai[o.komponennilai_nama]=0),n.bobot.bobotkelas.praktek>0&&(k>l&&(l=k),k<e&&(e=k)),null==i.nilaikd[o.komponennilai_nama]&&(i.nilaikd[o.komponennilai_nama]={},i.nilaikd[o.komponennilai_nama].nilai=0,i.nilaikd[o.komponennilai_nama].tnilai=0,i.nilaikd[o.komponennilai_nama].uk=0,i.nilaikd[o.komponennilai_nama].pro=0,i.nilaikd[o.komponennilai_nama].por=0),i.nilaikd[o.komponennilai_nama].komponennilai_materi=o.komponennilai_materi,i.nilaikd[o.komponennilai_nama].nama=o.komponennilai_nama,i.nilaikd[o.komponennilai_nama].tnilai++,i.nilaikd[o.komponennilai_nama].nilai+=k,i.nilaikd[o.komponennilai_nama].uk=k,t+=k})),a.uk=Math.round(t/n.komponenuk.length,0)}else a.nilaiuk=null,a.uk=0,n.bobot.bobotkelas.praktek>0&&(e=0);if(a.pronilai=[],void 0!==n.datapro[a.siswa_id]){a.nilaipro=n.datapro[a.siswa_id];var k=0;angular.forEach(n.komponenpro,(function(o){var t;void 0!==a.nilaipro[o.komponennilai_id]?(t=parseInt(a.nilaipro[o.komponennilai_id]),a.pronilai[o.komponennilai_nama]=t):(a.pronilai[o.komponennilai_nama]=0,t=0),n.bobot.bobotkelas.proyek>0&&(t>l&&(l=t,descmax=o.komponennilai_materi),t<e&&(e=t,descmin=o.komponennilai_materi)),null==i.nilaikd[o.komponennilai_nama]&&(i.nilaikd[o.komponennilai_nama]={},i.nilaikd[o.komponennilai_nama].nilai=0,i.nilaikd[o.komponennilai_nama].tnilai=0,i.nilaikd[o.komponennilai_nama].uk=0,i.nilaikd[o.komponennilai_nama].pro=0,i.nilaikd[o.komponennilai_nama].por=0),i.nilaikd[o.komponennilai_nama].komponennilai_materi=o.komponennilai_materi,i.nilaikd[o.komponennilai_nama].nama=o.komponennilai_nama,i.nilaikd[o.komponennilai_nama].nilai+=t,i.nilaikd[o.komponennilai_nama].pro=t,i.nilaikd[o.komponennilai_nama].tnilai++,k+=t})),a.pro=Math.round(k/n.komponenpro.length,0)}else a.nilaipro=null,a.pro=0,n.bobot.bobotkelas.proyek>0&&(e=0);if(a.pornilai=[],void 0!==n.datapor[a.siswa_id]){a.nilaipor=n.datapor[a.siswa_id];var p=0;angular.forEach(n.komponenpor,(function(o){var t;void 0!==a.nilaipor[o.komponennilai_id]?(t=parseInt(a.nilaipor[o.komponennilai_id]),a.pornilai[o.komponennilai_nama]=t):(a.pornilai[o.komponennilai_nama]=0,t=0),n.bobot.bobotkelas.porto>0&&(t>l&&(l=t,descmax=o.komponennilai_materi),t<e&&(e=t,descmin=o.komponennilai_materi)),null==i.nilaikd[o.komponennilai_nama]&&(i.nilaikd[o.komponennilai_nama]={},i.nilaikd[o.komponennilai_nama].nilai=0,i.nilaikd[o.komponennilai_nama].tnilai=0,i.nilaikd[o.komponennilai_nama].uk=0,i.nilaikd[o.komponennilai_nama].pro=0,i.nilaikd[o.komponennilai_nama].por=0),i.nilaikd[o.komponennilai_nama].komponennilai_materi=o.komponennilai_materi,i.nilaikd[o.komponennilai_nama].nama=o.komponennilai_nama,i.nilaikd[o.komponennilai_nama].nilai+=t,i.nilaikd[o.komponennilai_nama].por=t,i.nilaikd[o.komponennilai_nama].tnilai++,p+=t})),a.por=Math.round(p/n.komponenpor.length,0)}else a.nilaipor=null,a.por=0,n.bobot.bobotkelas.porto>0&&(e=0);if(console.log(i.nilaikd),a.finalkd=[],i.nilaikd.length>0){var r=0,d=0,m="",s="",u=100,_=0;angular.forEach(i.nilaikd,(function(n){d++,n.tnilai>0&&(n.nilaikd=n.nilai/n.tnilai,r+=n.nilai/n.tnilai,_<n.nilaikd&&(m=n.komponennilai_materi,_=n.nilaikd),u>n.nilaikd&&(s=n.komponennilai_materi,u=n.nilaikd)),i.finalkd.push(n),a.finalkd.push(n)})),console.log(i.finalkd),console.log(a.finalkd),a.rapork=Math.round(r/d,2)}else a.rapork=0;if(i.FilPredikat=n.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapork&&parseInt(i.kkmgrade_max)>=a.rapork})),i.FilPredikat.length>0){a.predikatk=i.FilPredikat[0].kkmgrade_kode;parseInt(n.kkmdata.kkmtingkat_nilai);var c="";c="A"==a.predikatk?"Sangat terampil terutama dalam "+m:"B"==a.predikatk?"Terampil terutama dalam "+m:"C"==a.predikatk?"Cukup terampil terutama dalam "+m:u>0?"Kurang terampil terutama dalam "+s:"Kurang terampil terutama dalam "+m,a.desck=c,0==a.rapork&&(a.desck="")}else a.predikatk="-";void 0!==n.dataRapork[a.siswa_id]&&(a.rapork=n.dataRapork[a.siswa_id].rapor_nilai,a.predikatk=n.dataRapork[a.siswa_id].rapor_predikat,a.desck=n.dataRapork[a.siswa_id].rapor_deskripsi),console.log(a),n.dataketerampilan.push(a),console.log(i.dtInstance)}}))}))}}]);
angular.module("RdmApp").controller("keterampilanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(i,a,l,e,t,n,o,r,s){a.knilai={},i.editKompnilai=function(l){a.knilai.edit=!0,a.knilai.komponennilai_id=l.komponennilai_id,a.knilai.komponennilai_materi=l.komponennilai_materi,a.knilai.komponennilai_nama=l.nama,a.knilai.uk={},a.knilai.pro={},a.knilai.por={},angular.forEach(a.dataketerampilan,(function(e){i.FilNilai=e.finalkd.filter((function(i){return i.nama==l.nama})),console.log("Finalkd:"),console.log(e.finalkd),console.log("Edit:"),console.log(l),i.FilNilai.length>0?(parseInt(i.FilNilai[0].uk)>0?a.knilai.uk[e.siswa_id]=parseInt(i.FilNilai[0].uk):a.knilai.uk[e.siswa_id]="",parseInt(i.FilNilai[0].pro)>0?a.knilai.pro[e.siswa_id]=parseInt(i.FilNilai[0].pro):a.knilai.pro[e.siswa_id]="",parseInt(i.FilNilai[0].por)>0?a.knilai.por[e.siswa_id]=parseInt(i.FilNilai[0].por):a.knilai.por[e.siswa_id]=""):(a.knilai.uk[e.siswa_id]="",a.knilai.pro[e.siswa_id]="",a.knilai.por[e.siswa_id]="")})),console.log(a.knilai),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},i.tambahharian=function(){a.knilai={},a.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},i.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("guru/keterampilan/saveketall",a.knilai,(function(i){$.unblockUI({}),i.success?(a.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((i=>{i.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},i.kirimNilai=function(){a.knilai.kirimnilai=[],$i=0,a.knilai.selectKelas=a.selectKelas;var i=!1;angular.forEach(a.dataharian,(function(l){var e={};e.siswa_id=l.siswa_id,e.rapor=l.rapork,parseInt(l.rapork)&&(i=!0),e.predikat=l.predikatk,e.desc=l.desck,a.knilai.kirimnilai[$i]=e,$i++})),i?($.blockUI({}),r.post("guru/keterampilan/kirimnilai",a.knilai,(function(i){$.unblockUI({}),a.getketerampilan(),a.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){a.knilai.kirimnilai=[],a.knilai.selectKelas=a.selectKelas,$.blockUI({}),r.post("guru/keterampilan/batalnilai",a.knilai,(function(i){$.unblockUI({}),a.getketerampilan(),a.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){a.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("responsive",!0).withOption("paging",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("nilaiCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,n,t,l,o,s,e,c,p){i.dtInstance={},n.walasnilai={},n.dataketerampilan=[],n.bobot=[],n.kkmdata=[],i.$on("KelasChange",(function(a,i){i.length>0&&n.getwalasnilai()})),n.locknilai=function(a){""!==n.walas&&($.blockUI({}),p.post("guru/walas/locknilai/"+n.walas,{status:a},(function(a){$.unblockUI({}),n.getwalasnilai()})))},n.getwalasnilai=function(){""!==n.walas&&($.blockUI({}),p.get("guru/walas/datanilai/"+n.walas,(function(a){$.unblockUI({}),n.walasnilai=a.data,n.walaskirim=a.kirim,n.nilailock=a.nilailock})))},n.getwalasnilai(),i.dtOptions=o.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("nilaiketerampilanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,t,i,n,l,o,s,r){e.knilai={},a.tambahharian=function(){e.knilai={},e.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((t=>{t.value&&($.blockUI({}),s.post("guru/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),e.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/keterampilan/nilaiket",e.knilai,(function(a){$.unblockUI({}),a.success?(e.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Absen Siswa","RDM")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){e.knilai={},e.knilai.edit=!1,$(".upload-modal").modal("show")};var u=a.uploader=new r({url:base_url+"guru/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){u.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},u.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|xls|xlsx|".indexOf(t)}}),u.onSuccessItem=function(e,t,i,n){a.berhasilka=a.berhasilka+t.sukses,a.gandaaa=a.gandaaa+t.double1,a.gagalaa=a.gagalaa+t.gagal,a.$apply(),console.info("onSuccessItem",e,t,i,n,a.gandaaa)},u.onCompleteAll=function(){e.getketerampilan()},u.onBeforeUploadItem=function(a){a.url=base_url+"guru/keterampilan/importnilai/praktek/"+e.selectKelas},u.onAfterAddingAll=function(a){u.uploadAll()}}]);
angular.module("RdmApp").controller("paspatCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,t,l,o,s,r){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datasiswa,(function(i){i.paspat=a}))},a.tambahpas=function(){i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.simpanPasPat=function(){i.knilai={},i.knilai.nilaipas={},angular.forEach(i.datasiswa,(function(a){i.knilai.nilaipas[a.siswa_id]=a.paspat})),$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/pengetahuan/savepaspat/"+i.selectKelas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getharian(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("tabIndex",-1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new r({url:base_url+"guru/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,t){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,t,a.gandaaa)},p.onCompleteAll=function(){i.getharian()},p.onBeforeUploadItem=function(a){a.url=base_url+"guru/pengetahuan/importnilai/paspat/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("pengetahuanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(i,t,a,e,n,l,r,o,s){t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.dataharian,(function(a){var e={};e.siswa_id=a.siswa_id,e.rapor=a.rapor,parseInt(a.rapor)&&(i=!0),e.predikat=a.predikat,e.desc=a.desc,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=e,$i++})),i?($.blockUI({}),o.post("guru/pengetahuan/kirimnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),o.post("guru/pengetahuan/batalnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=e.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("responsive",!0).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("portofolioCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaipor&&void 0!==n.nilaipor[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaipor[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("guru/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("guru/keterampilan/saveforto",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("fixedColumns",{leftColumns:2}).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("tabIndex",-1).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var m=a.uploader=new s({url:base_url+"guru/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){m.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},m.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),m.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),m.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},m.onCompleteAll=function(){i.getketerampilan()},m.onBeforeUploadItem=function(a){a.url=base_url+"guru/keterampilan/importnilai/porto/"+i.selectKelas},m.onAfterAddingAll=function(a){m.uploadAll()}}]);
angular.module("RdmApp").controller("prestasiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,i,e,o,s,n,d,l){a.dataEdit={},a.dodataTambah=function(){a.dataEdit={},a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dodataEdit=function(t,i){a.dataEdit={},a.dataEdit.edit=!0,a.dataEdit.siswa_id=t,a.dataEdit.prestasi_id=i.prestasi_id,a.dataEdit.prestasi_keterangan=i.prestasi_keterangan,a.dataEdit.prestasi_nama=i.prestasi_nama,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("guru/walas/saveprestasi/"+t.walas,a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((i=>{i.value&&($.blockUI({}),d.post("guru/walas/deleteprestasi",a,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("proyekCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaipro&&void 0!==n.nilaipro[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaipro[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("guru/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("guru/keterampilan/saveproyek",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("tabIndex",-1).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new s({url:base_url+"guru/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},p.onCompleteAll=function(){i.getketerampilan()},p.onBeforeUploadItem=function(a){a.url=base_url+"guru/keterampilan/importnilai/proyek/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("raporCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,l,s,n,o,d){a.dtInstance={},a.dataEdit={},a.setnaikKelas=function(a,e){console.log(a),console.log(e),$.blockUI({}),o.post("guru/walas/naikkelas/"+t.walas,{siswa_id:a,absen_siswanaik:e},(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&t.getwalassiswa()}))}))},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),o.post("guru/siswa/save",a.dataEdit,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{e.value&&($.blockUI({}),o.post("guru/siswa/delete",{siswa_id:t},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},a.reloadTable=function(){t.datasiswa={},""!==a.selectData.kelas_id&&t.getdatasiswa(a.selectData)},a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var r=a.uploader=new d({url:base_url+"guru/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){r.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},r.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),r.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),r.onSuccessItem=function(t,e,i,l){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,l,a.gandaaa)},r.onCompleteAll=function(){a.reloadTable()},r.onBeforeUploadItem=function(t){t.url=base_url+"guru/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},r.onAfterAddingAll=function(a){r.uploadAll()}}]);
angular.module("RdmApp").controller("sikapCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,s,r){i.knilai={},a.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.dataharian,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilai.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("guru/sikap/deletesikap",a,(function(a){$.unblockUI({}),i.updateSikap(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/sikap/savesikap",i.knilai,(function(a){$.unblockUI({}),a.success?(i.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new r({url:base_url+"guru/sikap/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},p.onCompleteAll=function(){i.updateSikap()},p.onBeforeUploadItem=function(a){a.url=base_url+"guru/sikap/importnilai/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("sikapsosCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,l,e,t,o,s,r){i.knilai={},i.knilai.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.datasikapsos,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.sikapAll="",i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilaisos.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai.sikapAll="",i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("guru/sikap/deletesikapwalas",a,(function(a){$.unblockUI({}),i.getSikapsos(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/sikap/savesikapwalas/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getSikapsos(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=l.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new r({url:base_url+"guru/sikap/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,l,e){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,l,e,a.gandaaa)},p.onCompleteAll=function(){i.getSikapsos()},p.onBeforeUploadItem=function(a){a.url=base_url+"guru/sikap/importnilaiwalas/sos/"+i.walas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("sikapspiritualCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,s,p){i.knilai={},a.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.datasikapspi,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilaispi.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("guru/sikap/deletesikapwalas",a,(function(a){$.unblockUI({}),i.getSikapsspi(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/sikap/savesikapwalas/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getSikapsspi(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var r=a.uploader=new p({url:base_url+"guru/sikap/importnilaiwalas"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){r.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},r.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),r.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),r.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},r.onCompleteAll=function(){i.getSikapsspi()},r.onBeforeUploadItem=function(a){a.url=base_url+"guru/sikap/importnilaiwalas/spi/"+i.walas},r.onAfterAddingAll=function(a){r.uploadAll()}}]);
angular.module("RdmApp").controller("siswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,l,n,o,s,d){a.dtInstance={},a.dataEdit={},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("guru/siswa/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("guru/siswa/delete",{siswa_id:t},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},a.reloadTable=function(){t.datasiswa={},""!==a.selectData.kelas_id&&t.getdatasiswa(a.selectData)},a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.dodataEdit=function(t){a.dataEdit=t,a.dataEdit.edit=!0,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,2,3,4,5]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3,4,5]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{setTimeout((function(){a.$apply()}),1e3)}catch(a){}})).withPaginationType("full_numbers");var r=a.uploader=new d({url:base_url+"guru/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){r.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},r.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),r.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),r.onSuccessItem=function(t,e,i,l){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,l,a.gandaaa)},r.onCompleteAll=function(){a.reloadTable()},r.onBeforeUploadItem=function(t){t.url=base_url+"guru/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},r.onAfterAddingAll=function(a){r.uploadAll()}}]);
angular.module("RdmApp").controller("timelineCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","nowTime",function(e,t,a,n,i,l,s,o,u){t.dataTimeline=[],void 0!==t.datakelas[t.selectKelas]?void 0!==t.datakelas[t.selectKelas].timeline?t.dataTimeline=t.datakelas[t.selectKelas].timeline:t.datakelas[t.selectKelas].timeline=[]:(t.datakelas[t.selectKelas]=[],t.datakelas[t.selectKelas].timeline=[]),e.nowTime=u,e.row=0,e.rowperpage=3,e.newPost={},e.newKomen={},e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=3,e.busy=!1,e.loading=!1,e.setType=function(t){e.newPost.type=t},e.saveComent=function(t,a){$.blockUI({}),e.newKomen={},e.newKomen.forumrespon_komentar=a,e.newKomen.forum_id=t.forum_id,o.post("guru/timeline/savekomen",e.newKomen,(function(a){$.unblockUI({}),a.success?(e.updatePosts(t),e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=3,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},e.browseimage=function(){$("#imageFile").click()},e.removeImage=function(){e.newPost.image=""},e.sendPost=function(){$.blockUI({}),o.post("guru/timeline/save",e.newPost,(function(t){$.unblockUI({}),t.success?(e.getnewPosts(),e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},e.getnewPosts=function(){t.dataTimeline.length>0&&(forum_id=t.dataTimeline[0].forum_id),o.get("guru/timeline/newdata/"+forum_id,(function(a){a.success&&(e.row+=e.rowperpage,e.$apply((function(){angular.forEach(a.data,(function(e){t.dataTimeline.unshift(e)})),null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline,setTimeout((function(){$(".lazy").Lazy()}),1e3)})))}))},e.updatePosts=function(e){$.blockUI({}),forum_id=e.forum_id,o.get("guru/timeline/getupdatedata/"+forum_id,(function(a){if($.unblockUI({}),a.success){e=a.data;const n=t.dataTimeline.findIndex((e=>e.forum_id===a.data.forum_id));t.dataTimeline[n]=a.data,null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline}}))},e.getPosts=function(){e.busy||(e.loading=!0,e.busy=!0,forum_id="0",t.dataTimeline.length>0&&(forum_id=t.dataTimeline[t.dataTimeline.length-1].forum_id),o.get("guru/timeline/data/"+forum_id,(function(a){a.success?a.data.length>0?(e.row+=e.rowperpage,e.$apply((function(){angular.forEach(a.data,(function(e){t.dataTimeline.push(e)})),null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline,e.busy=!1,e.loading=!1,setTimeout((function(){$(".lazy").Lazy()}),1e3)}))):(e.busy=!0,e.loading=!1):(e.busy=!1,e.loading=!1)})))},e.$on("pictureInsert",(function(t,a){e.newPost.image=a})),0==t.dataTimeline.length&&e.getPosts(),$("#postText").focus()}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(e){return{restrict:"A",scope:!0,link:function(t,a,n){a.bind("change",(function(){$.blockUI({});var n=new FormData;n.append("file",a[0].files[0]);var i=a[0].getAttribute("data-url");a[0].getAttribute("image-container");e(i,n,(function(e){$.unblockUI({}),e&&e.success?t.$emit("pictureInsert",e.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.data})}))}))}}}]);
angular.module("RdmApp").controller("unjukkerjaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaiuk&&void 0!==n.nilaiuk[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaiuk[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("guru/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("guru/keterampilan/saveunjukkerja",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var u=a.uploader=new s({url:base_url+"guru/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){u.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},u.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),u.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},u.onCompleteAll=function(){i.getketerampilan()},u.onBeforeUploadItem=function(a){a.url=base_url+"guru/keterampilan/importnilai/praktek/"+i.selectKelas},u.onAfterAddingAll=function(a){u.uploadAll()}}]);
angular.module("RdmApp").controller("walasCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,o,n,t,e,r,s,p,k){o.dataharian=[],o.dataketerampilan=[],o.bobot=[],o.kkmdata=[],i.$on("KelasChange",(function(a,i){i.length>0&&o.getwalassiswa()})),o.getwalassiswa=function(){""!==o.walas&&($.blockUI({}),k.get("guru/walas/datasiswa/"+o.walas,(function(a){$.unblockUI({}),o.getSikapsos(),o.getSikapsspi(),o.tingkatwalas=a.tingkat,o.walassiswa=a.data,o.dataabsen=a.dataabsen,o.dataprestasi=a.dataprestasi,angular.forEach(o.walassiswa,(function(a){void 0!==o.dataabsen[a.siswa_id]?a.absen=o.dataabsen[a.siswa_id]:a.absen={},void 0!==o.dataprestasi[a.siswa_id]?a.prestasi=o.dataprestasi[a.siswa_id]:a.prestasi={}}))})))},o.getwalassiswa(),o.dataRapor={},o.getharian=function(){k.get("guru/pengetahuan/harian",(function(a){o.dataharian=[],o.datakomponen=a.komponen,o.datanilai=a.datanilai,o.datapas=a.datapas,o.dataRapor=a.datarapor,console.clear(),angular.forEach(o.datasiswa,(function(a){var n=0,t="",e="",r=100;if(void 0!==o.datanilai[a.siswa_id]){a.nilai=o.datanilai[a.siswa_id],void 0!==o.datapas[a.siswa_id]?a.paspat=parseInt(o.datapas[a.siswa_id]):(a.paspat=0,o.bobot.bobotkelas.paspat>0&&(r=0));var s=0;angular.forEach(o.datakomponen,(function(i){var o;(o=void 0!==a.nilai[i.komponennilai_id]?parseInt(a.nilai[i.komponennilai_id]):0)>n&&(n=o,t=i.komponennilai_materi),o<r&&(r=o,e=i.komponennilai_materi),s+=o})),a.nilaiharian=Math.round(s/o.datakomponen.length,0)}else a.nilai=null,a.nilaiharian=0,a.paspat=0,o.bobot.bobotkelas.harian>0&&(r=0),o.bobot.bobotkelas.paspat>0&&(r=0);if(void 0!==o.dataRapor[a.siswa_id])a.rapor=o.dataRapor[a.siswa_id].rapor_nilai,a.predikat=o.dataRapor[a.siswa_id].rapor_predikat,a.desc=o.dataRapor[a.siswa_id].rapor_deskripsi;else if(a.nilaiharian+a.paspat>0?a.rapor=Math.round((a.nilaiharian*o.bobot.bobotkelas.harian+a.paspat*o.bobot.bobotkelas.paspat)/(o.bobot.bobotkelas.harian+o.bobot.bobotkelas.paspat),2):a.rapor=0,i.FilPredikat=o.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapor&&parseInt(i.kkmgrade_max)>=a.rapor})),i.FilPredikat.length>0){a.predikat=i.FilPredikat[0].kkmgrade_kode;var p=parseInt(o.kkmdata.kkmtingkat_nilai),k="";k="A"==a.predikat?"sangat baik":"B"==a.predikat?"baik":"C"==a.predikat?"cukup baik":"kurang baik",a.desc=p<=r&&p<=n?"Memiliki kompetensi dari semua materi yang "+k+" terutama menguasai "+t:p>r&&r>0&&p<=n?"Memiliki kompetensi dari semua materi yang "+k+" terutama menguasai "+t+", dan perlu ditingkatkan dalam "+e:"Perlu pebaikan kompetensi pada seluruh materi",0==a.rapor&&(a.desc="")}else a.predikat="-",a.desc="";o.dataharian.push(a)}))}))},o.getketerampilan=function(){k.get("guru/keterampilan/dataketerampilan",(function(a){o.dataketerampilan=[],o.komponenuk=a.komponenuk,o.datauk=a.datauk,o.komponenpro=a.komponenpro,o.datapro=a.datapro,o.komponenpor=a.komponenpor,o.datapor=a.datapor,angular.forEach(o.datasiswa,(function(a){var n=0,t="",e="",r=100;if(void 0!==o.datauk[a.siswa_id]){a.nilaiuk=o.datauk[a.siswa_id];var s=0;angular.forEach(o.komponenuk,(function(i){var p;p=void 0!==a.nilaiuk[i.komponennilai_id]?parseInt(a.nilaiuk[i.komponennilai_id]):0,o.bobot.bobotkelas.praktek>0&&(p>n&&(n=p,t=i.komponennilai_materi),p<r&&(r=p,e=i.komponennilai_materi)),s+=p})),a.uk=Math.round(s/o.komponenuk.length,0)}else a.nilaiuk=null,a.uk=0,o.bobot.bobotkelas.praktek>0&&(r=0);if(void 0!==o.datapro[a.siswa_id]){a.nilaipro=o.datapro[a.siswa_id];var p=0;angular.forEach(o.komponenpro,(function(i){var s;s=void 0!==a.nilaipro[i.komponennilai_id]?parseInt(a.nilaipro[i.komponennilai_id]):0,o.bobot.bobotkelas.proyek>0&&(s>n&&(n=s,t=i.komponennilai_materi),s<r&&(r=s,e=i.komponennilai_materi)),p+=s})),a.pro=Math.round(p/o.komponenpro.length,0)}else a.nilaipro=null,a.pro=0,o.bobot.bobotkelas.proyek>0&&(r=0);if(void 0!==o.datapor[a.siswa_id]){a.nilaipor=o.datapor[a.siswa_id];var k=0;angular.forEach(o.komponenpor,(function(i){var s;s=void 0!==a.nilaipor[i.komponennilai_id]?parseInt(a.nilaipor[i.komponennilai_id]):0,o.bobot.bobotkelas.porto>0&&(s>n&&(n=s,t=i.komponennilai_materi),s<r&&(r=s,e=i.komponennilai_materi)),k+=s})),a.por=Math.round(k/o.komponenpor.length,0)}else a.nilaipor=null,a.por=0,o.bobot.bobotkelas.porto>0&&(r=0);if(a.uk+a.pro+a.por>0?a.rapork=Math.round((a.uk*o.bobot.bobotkelas.praktek+a.pro*o.bobot.bobotkelas.proyek+a.por*o.bobot.bobotkelas.porto)/(o.bobot.bobotkelas.praktek+o.bobot.bobotkelas.proyek+o.bobot.bobotkelas.porto),2):a.rapork=0,i.FilPredikat=o.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapork&&parseInt(i.kkmgrade_max)>=a.rapork})),i.FilPredikat.length>0){a.predikatk=i.FilPredikat[0].kkmgrade_kode;var l=parseInt(o.kkmdata.kkmtingkat_nilai),d="";d="A"==a.predikatk?"sangat baik":"B"==a.predikatk?"baik":"C"==a.predikatk?"cukup baik":"kurang baik",a.desck=l<=r&&l<=n?"Memiliki kompetensi dari semua materi yang "+d+" terutama menguasai "+t:l>r&&r>0&&l<=n?"Memiliki kompetensi dari semua materi yang "+d+" terutama menguasai "+t+", dan perlu ditingkatkan dalam "+e:"Perlu pebaikan kompetensi pada seluruh materi",0==a.rapork&&(a.desck="")}else a.predikatk="-";o.dataketerampilan.push(a)}))}))},o.getSikapsos=function(){$.blockUI({}),k.get("guru/sikap/datasikapsos/"+o.walas,(function(a){$.unblockUI({}),o.datasikapsos=[],o.datakomponensikapsos=a.komponen,o.datanilaisikapsos=a.datanilai,o.jenisnilaisos=a.jenisnilai,angular.forEach(o.walassiswa,(function(a){o.datasikapsos.push(a)})),o.jnilaisos=0,angular.forEach(o.jenisnilaisos,(function(a){a.cnilai>0&&o.jnilaisos++}))}))},o.getSikapsspi=function(){$.blockUI({}),k.get("guru/sikap/datasikapspi/"+o.walas,(function(a){$.unblockUI({}),o.datasikapspi=[],o.datakomponensikapspi=a.komponen,o.datanilaisikapspi=a.datanilai,o.jenisnilaispi=a.jenisnilai,angular.forEach(o.walassiswa,(function(a){o.datasikapspi.push(a)})),o.jnilaispi=0,angular.forEach(o.jenisnilaispi,(function(a){a.cnilai>0&&o.jnilaispi++}))}))}}]);
